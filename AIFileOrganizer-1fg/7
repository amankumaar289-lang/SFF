Библиотека «Процессы обработки документов»
Состав библиотеки	3
Внедрение библиотеки	4
Перенос объектов метаданных из файла поставки библиотеки в конфигурацию	4
Первое внедрение	4
Обновление версии библиотеки	4
Настройка объектов библиотеки и конфигурации	5
Настройка объектов библиотеки	5
Настройка объектов конфигурации	6
Особенности внедрения библиотеки в другие конфигурации	12
Бухгалтерия государственного учреждения, редакция 2	12
Зарплата и кадры государственного учреждения КОРП, редакция 3.1	12
1С:Бюджет поселения 8, редакция 1.3	12
Особые случаи обновления информационной базы	12
Появление составного типа для объектов адресации задач	12
Настройка и использование библиотеки при разработке конфигурации	13
Настройка интерфейса пользователя	13
Настройка прав пользователей	14
Настройка обмена данными	15
Программный интерфейс	15
Общий модуль ПроцессыОбработкиДокументовПереопределяемый, переопределяемые процедуры и функции	15
Общий модуль ПроцессыОбработкиДокументовКлиентПереопределяемый, переопределяемые процедуры и функции	18
Подключаемые обработчики	19
Инициирующие события	20
Специальные ключи параметра ДополнительныеСвойства в обработчике ПередЗаписью	21
Пользовательская документация	22
Настройки программы	22
Настройка ограничений доступа	25
Производительный вариант работы ограничения доступа	26
Стандартный вариант работы ограничения доступа	27
Создание шаблонов процессов	27
Справочник Статусы документов	29
Справочник Этапы процессов	30
Справочник Шаблоны процессов	32
Настройка использования шаблонов	55
Регламентные интервалы	57
Справочник Регламентные интервалы	57
Ввод в действие и механика работы	61
Мониторинг и изменение сроков выполнения	61
Электронная подпись	64
Настройка усиленной электронной подписи	65
Настройка простой электронной подписи	65
Реестры выданных и отозванных ключей простой электронной подписи	66
Использование электронной подписи для подписания документов	68
Настройка подписи ссылочных данных	74
Настройка прав назначения исполнителей	77
Передача прав исполнителей	79
Дополнительные задания	82
Справочник Виды дополнительных заданий	82
Документ Дополнительное задание	83
Дополнительные колонки списков задач	89
Сервисные возможности и администрирование	93
Импорт / экспорт шаблонов процессов	93
Обмен настройками подписи ссылочных данных	97
Обмен настройками дополнительных колонок списков задач	98
Принудительный запуск этапа процесса	100
Принудительное прерывание процессов выполнения задач	102
Работа с задачами по обработке документов	104
Работа со списком задач	104
Работа с формами документов	109
Карточка процесса	111
Документ с процессами обработки	114
Настройки исполнителя задач	117
Мониторинг задач	118

Библиотека «Процессы обработки документов» предназначена для организации бизнес-процессов обработки документов (прикладных объектов конфигураций).
Она предназначена для встраивания в различные прикладные решения, разработанные на платформе 1С:Предприятие 8, и предоставляет возможность пользователям этих решений выполнять задачи по обработке документов из привычных им форм документов прикладных решений.

Функциональные возможности библиотеки:
•	обеспечение поэтапной обработки документов в соответствии с преднастроенными шаблонами бизнес-процессов;
•	настройка собственной системы статусов (состояний) документов и этапов процессов;
•	распределение процесса обработки документа по ответственным пользователям согласно должностным обязанностям, разграничение зон ответственности исполнителей этапов по реквизитам документа;
•	использование электронной подписи при принятии решений по обработке документа, в том числе подпись наборов реквизитов в зоне ответственности исполнителя;
•	выполнение прикладной логики при выполнении задач при помощи подключаемых обработчиков-процедур и точек переопределения;
•	информирование пользователей об их текущих задачах по обработке документов;
•	мониторинг и контроль выполнения задач пользователей, ручное назначение задач при наличии конкурирующих исполнителей.

Состав библиотеки

Библиотека совместима с версией платформы «1С:Предприятие 8.3» версии не ниже 8.3.14 с отключенным режимом совместимости, а также с включенным или отключенным режимом использования модальности, включенным или отключенным режимом использования синхронности. Для работы библиотеки необходимо наличие в конфигурации встроенной библиотеки стандартных подсистем (БСП) версии не ниже 3.1.2, а именно следующих ее подсистем (за исключением подсистем БСП, обязательных к внедрению):
•	Бизнес-процессы и задачи (используется функционал по настройке ролевой адресации);
•	Управление доступом (используется в ограничениях доступа);
•	Подключаемые команды (используется для формирования печатных форм)
•	Варианты отчетов
•	Регламентные задания
•	Свойства
•	Электронная подпись (опционально, если предполагается использовать электронную подпись при подтверждении выполнения этапа или подписи набора реквизитов документа);
•	Работа с файлами (опционально, если предполагается подписывать с помощью ЭП файлы, присоединенные к документу;
•	Печать (опционально, если предполагается вывод штампа визуализации ЭП в печатные формы документов);
•	Графики работы (опционально, если предполагается использовать графики работы БСП для расчета сроков выполнения задач)
•	Работа с почтовыми сообщениями (опционально, если предполагается использовать уведомления исполнителям по почте)
•	Версионирование объектов (опционально, если предполагается хранить историю изменений (версий) шаблонов процессов)

Также библиотека содержит собственную подсистему Процессы обработки документов, объекты которой в ходе внедрения переносятся в прикладное решение.
При обновлении версии библиотеки, как правило, достаточно обновить объекты подсистемы Процессы обработки документов. Повторное внесение изменений в объекты интегрированной системы не требуется.

Внедрение библиотеки
Первое внедрение библиотеки в конфигурацию и обновление версии уже внедренной библиотеки отличаются. Процесс внедрения состоит из двух этапов:
•	Перенос объектов метаданных из файла поставки библиотеки в конфигурацию. 
•	Настройка объектов библиотеки и конфигурации.

Весь функционал библиотеки относится к подсистеме ПроцессыОбработкиДокументов в дереве объектов метаданных конфигуратора.

Перенос объектов метаданных из файла поставки библиотеки в конфигурацию
Первое внедрение
Для выполнения переноса объектов библиотеки в конфигурацию при первом внедрении необходимо выполнить следующие действия:
1.	В режиме Конфигуратор выполнить команду меню Конфигурация – Сравнить, объединить с конфигурацией из файла...
2.	В диалоговом окне указать файл поставки библиотеки и подтвердить запрос о постановке к ней на поддержку.
3.	В открывшемся окне сравнения и объединения конфигураций необходимо снять все флажки и отметить переносимые объекты с помощью команды Действия – Отметить по подсистемам файла.
4.	В открывшемся дереве подсистем необходимо отметить ПроцессыОбработкиДокументов (не корневую, а подчиненную корневой) и нажать кнопку Установить.
5.	Выбрать режим объединения Взять из файла (Действия – Установить режим для всех…) и нажать кнопку Выполнить.
6.	При отображении окна со списком зависимых объектов нажать кнопку Продолжить.
После завершения объединения необходимо перейти ко второму этапу – настройка объектов библиотеки и конфигурации.
Если при первом внедрении библиотеки не увеличивался номер версии основной конфигурации, то при первом запуске информационной базы после внедрения необходимо выполнить обновление вспомогательных данных, например, запустить приложение с параметром запуска ЗапуститьОбновлениеИнформационнойБазы.

Обновление версии библиотеки
Особенности обновления каждой конкретной версии библиотеки описаны в файле updateDP.htm, входящем в комплект поставки.
Для обновления версии библиотеки необходимо выполнить следующие действия:
1.	В режиме Конфигуратор выполнить команду Конфигурация – Поддержка – Обновить конфигурацию…
2.	В открывшемся окне следует выбрать вариант Выбор файла обновления, нажать Далее, указать файл поставки библиотеки и подтвердить запрос об обновлении версии конфигурации поставщика.
3.	В окне сравнения и объединения конфигураций необходимо снять все флажки и отметить переносимые объекты с помощью команды Действия – Отметить по подсистемам новой конфигурации поставщика.
4.	В открывшемся дереве подсистем отметить подсистему ПроцессыОбработкиДокументов (не корневую, а подчиненную корневой!) и нажать кнопку Установить.
5.	Снять отметки с определяемых типов ПредметПроцессаОбработкиДокументов и ПредметПроцессаОбработкиДокументовОбъект.
6.	Снять отметки с переопределяемых общих модулей ПроцессыОбработкиДокументовПереопределяемый, ПроцессыОбработкиДокументовКлиентПереопределяемый, ПроцессыОбработкиДокументовКлиентСерверПереопределяемый, ПроцессыОбработкиДокументовОбработчикиПереопределяемый, ПроцессыОбработкиДокументовКлиентОбработчикиПереопределяемый.
7.	Выбрать режим объединения Взять из файла и нажать кнопку Выполнить.
8.	При отображении окна со списком зависимых объектов нажать кнопку Продолжить.
После завершения сравнения и объединения следует внести необходимые изменения в состав переопределяемых общих модулей и других объектов конфигурации согласно разделу Настройка объектов библиотеки и конфигурации.
Если после обновления версии библиотеки не увеличивался номер версии основной конфигурации, то при первом запуске информационной базы после обновления необходимо выполнить обновление вспомогательных данных, например, запустить приложение с параметром запуска ЗапуститьОбновлениеИнформационнойБазы.

Настройка объектов библиотеки и конфигурации
Перед настройкой перенесенных объектов библиотеки необходимо принять следующие решения:
•	Какие документы из метаданных интегрируемой системы необходимо будет обрабатывать при помощи бизнес-процессов.
•	В каких формах списка и журналах документов необходимо выводить информацию о текущем статусе документа.
•	Будет ли использоваться электронная подпись при выполнении этапов-задач по обработке документов.
•	Будет ли требоваться вывод штампа визуализации электронной подписи в печатные формы документов.

Настройка объектов библиотеки
1.	В состав определяемых типов ПредметПроцессаОбработкиДокументов и ПредметПроцессаОбработкиДокументовОбъект необходимо включить типы документов, которые будут обрабатываться при помощи бизнес-процессов.
При каждом последующем обновлении не нужно получать состав определяемых типов из поставки.

2.	Регламентные задания ЗаполнениеДополнительныхКолонокЗадач и УведомлениеОНовыхЗадачахПоОбработкеДокументов исключить из состава всех разделителей.

3.	Если для расчета сроков выполнения задач предполагается использовать график работы из библиотеки, то в определяемом типе ОсновнойГрафикРаботыДляСроковВыполнения необходимо указать тип СправочникСсылка.Календари (вместо типа Строка в поставке).
При каждом последующем обновлении не нужно получать состав определяемого типа из поставки.

4.	Переопределяемые общие модули ПроцессыОбработкиДокументовПереопределяемый, ПроцессыОбработкиДокументовКлиентПереопределяемый, ПроцессыОбработкиДокументовКлиентСерверПереопределяемый, ПроцессыОбработкиДокументовОбработчикиПереопределяемый, ПроцессыОбработкиДокументовКлиентОбработчикиПереопределяемый.
Для настройки в конфигурации переопределяемых общих модулей рекомендуется придерживаться общего подхода:
•	При первой настройке переопределяемого общего модуля следует ознакомиться с документацией к его экспортным процедурам и функциям, приведенной в комментариях к ним, и при необходимости вписать реализацию в экспортные процедуры и функции модуля.
•	При каждом последующем обновлении переопределяемого общего модуля требуется перенести новые экспортные процедуры и функции, удалить устаревшие и убедиться, что комментарии, количество и имена параметров у всех функций совпадают с их библиотечными эквивалентами. При необходимости вписать реализацию в новые экспортные процедуры и функции модуля, а также актуализировать реализацию уже существующих функций, если в новой версии библиотеки было изменено их назначение или состав параметров.
Качественное описание методов переопределяемых модулей приведено в подразделе Программный интерфейс раздела Настройка и использование библиотеки при разработке конфигурации.

Настройка объектов конфигурации
1.	В процедуру ПриДобавленииПодсистем общего модуля ПодсистемыКонфигурацииПереопределяемый необходимо добавить фрагмент кода:
МодулиПодсистем.Добавить("ОбновлениеИнформационнойБазыПОД");

2.	В процедуру ПослеНачалаРаботыСистемы общего модуля ОбщегоНазначенияКлиентПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументовКлиент.ПослеНачалаРаботыСистемы();
// Конец ПроцессыОбработкиДокументов

3.	В процедуру ПриДобавленииПараметровРаботыКлиентаПриЗапуске общего модуля ОбщегоНазначенияПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПараметрыРаботыКлиентаПриЗапуске(Параметры);
// Конец ПроцессыОбработкиДокументов

4.	В процедуру ПриЗаполненииВидовОграниченийПравОбъектовМетаданных общего модуля УправлениеДоступомПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриЗаполненииВидовОграниченийПравОбъектовМетаданных(Описание);
// Конец ПроцессыОбработкиДокументов

5.	В процедуру ПриЗаполненииСписковСОграничениемДоступа общего модуля УправлениеДоступомПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриЗаполненииСписковСОграничениемДоступа(Списки);
// Конец ПроцессыОбработкиДокументов

6.	В состав определяемого типа ВладелецЗначенийКлючейДоступа включить типы ЗадачаСсылка.ЗадачаПоОбработкеДокумента, ДокументСсылка.ДополнительноеЗадание, СправочникСсылка.ДополнительноеЗаданиеПрисоединенныеФайлы, ДокументСсылка.ПредставлениеФормуляраПервичногоДокументаПОД, ДокументСсылка.ФормулярПервичногоДокументаПОД.

7.	В состав определяемого типа ВладелецЗначенийКлючейДоступаДокумент включить тип ДокументОбъект.ДополнительноеЗадание, ДокументОбъект.ФормулярПервичногоДокументаПОД, ДокументОбъект.ПредставлениеФормуляраПервичногоДокументаПОД.

8.	В состав определяемого типа ВладелецЗначенийКлючейДоступаОбъект включить типы ЗадачаОбъект.ЗадачаПоОбработкеДокумента, СправочникОбъект.РегламентныеИнтервалы, СправочникОбъект.ДополнительноеЗаданиеПрисоединенныеФайлы.

9.	В состав определяемого типа ВладелецЗначенийКлючейДоступаНаборЗаписей включить типы РегистрСведенийНаборЗаписей.НастройкаПравНазначенияИсполнителей и РегистрСведенийНаборЗаписей.РегламентныеИнтервалыДокументов

10.	В состав определяемого типа ПолеРегистраКлючейДоступаКРегистрам включить типы СправочникСсылка.РегламентныеИнтервалы, ДокументСсылка.ПредставлениеФормуляраПервичногоДокументаПОД, ДокументСсылка.ФормулярПервичногоДокументаПОД.

11.	В справочник ИдентификаторыОбъектовМетаданных добавить предопределенный элемент с именем РегистрСведенийРегламентныеИнтервалыДокументов.

12.	В состав определяемого типа ВладелецПрисоединенныхФайлов включить типы ДокументСсылка.ДополнительноеЗадание, ДокументСсылка.ПредставлениеФормуляраПервичногоДокументаПОД, ДокументСсылка.ФормулярПервичногоДокументаПОД.

13.	В состав определяемого типа ПрисоединенныйФайл включить типы СправочникСсылка.ДополнительноеЗаданиеПрисоединенныеФайлы, СправочникСсылка.ФормулярПервичногоДокументаПОДПрисоединенныеФайлы, СправочникСсылка.ПредставлениеФормуляраПервичногоДокументаПОДПрисоединенныеФайлы.

14.	В состав определяемого типа ПрисоединенныйФайлОбъект включить типы СправочникОбъект.ДополнительноеЗаданиеПрисоединенныеФайлы, СправочникОбъект.ПредставлениеФормуляраПервичногоДокументаПОДПрисоединенныеФайлы, СправочникОбъект.ФормулярПервичногоДокументаПОДПрисоединенныеФайлы.

15.	В состав плана обмена ОбновлениеИнформационнойБазы включить объекты Справочник.ДополнительноеЗаданиеПрисоединенныеФайлы и Задача.ЗадачаПоОбработкеДокумента.

16.	В процедуру ПриОпределенииОбъектовСКомандамиПечати общего модуля УправлениеПечатьюПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриОпределенииОбъектовСКомандамиПечати(СписокОбъектов);
// Конец ПроцессыОбработкиДокументов

17.	В процедуру НастроитьВариантыОтчетов общего модуля ВариантыОтчетовПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.НастроитьВариантыОтчетов(Настройки);
// Конец ПроцессыОбработкиДокументов

18.	В процедуру ПриОпределенииНастроекРегламентныхЗаданий общего модуля РегламентныеЗаданияПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриОпределенииНастроекРегламентныхЗаданий(Настройки);
// Конец ПроцессыОбработкиДокументов

19.	В процедуру ПриПолученииСпискаШаблонов общего модуля ОчередьЗаданийПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриПолученииСпискаШаблонов(ШаблоныЗаданий);
// Конец ПроцессыОбработкиДокументов

20.	В процедуру ПриОпределенииПсевдонимовОбработчиков общего модуля ОчередьЗаданийПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриОпределенииПсевдонимовОбработчиков(СоответствиеИменПсевдонимам);
// Конец ПроцессыОбработкиДокументов

21.	В процедуру ПриОпределенииОбъектовСКомандамиСозданияНаОсновании общего модуля СозданиеНаОснованииПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриОпределенииОбъектовСКомандамиСозданияНаОсновании(Объекты);
// Конец ПроцессыОбработкиДокументов

22.	В процедуру ПриПолученииПредопределенныхНаборовСвойств общего модуля УправлениеСвойствамиПереопределяемый необходимо вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриПолученииПредопределенныхНаборовСвойств(Наборы);
// Конец ПроцессыОбработкиДокументов

23.	Если предполагается выводить штамп визуализации электронной подписи в печатные формы документов, то необходимо в процедуру ПриПечати общего модуля УправлениеПечатьюПереопределяемый вставить фрагмент кода:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриПечати(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);
// Конец ПроцессыОбработкиДокументов

24.	Если предполагается использовать электронную подпись при выполнении этапов процессов обработки документов, то необходимо в состав определяемого типа ПодписанныйОбъект включить типы ЗадачаСсылка.ЗадачаПоОбработкеДокумента и СправочникСсылка.ДополнительноеЗаданиеПрисоединенныеФайлы, СправочникСсылка.ФормулярПервичногоДокументаПОДПрисоединенныеФайлы, СправочникСсылка.ПредставлениеФормуляраПервичногоДокументаПОДПрисоединенныеФайлы.

25.	Если предполагается хранить историю изменений шаблонов процессов, то необходимо в состав определяемых типов ВерсионируемыеДанные и ВерсионируемыеДанныеОбъект включить типы СправочникСсылка.ШаблоныПроцессов и СправочникОбъект. ШаблоныПроцессов соответственно.

26.	Для роли ПолныеПрава необходимо перенести из одноименной роли в файле поставки настройки прав на внедренные объекты метаданных библиотеки.

27.	Библиотека предоставляет возможность выполнять задачи по обработке документов непосредственно из форм этих документов. Для документов, обработка которых должна быть доступна в формах документов, необходимо:
•	Если требуется разместить элементы библиотеки в определенной группе формы, то на форму документа добавить новую группу вида Обычная группа с горизонтальной группировкой дочерних элементов. По умолчанию элементы библиотеки будут добавлены в конец формы.
•	В процедуру ПриСозданииНаСервере (обработчик события формы) вставить вызов по шаблону:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриСозданииНаСервере(ЭтотОбъект, <Объект>, <ГруппаПроцесс>, <ГруппаДляКнопкиПроцесс>);
// Конец ПроцессыОбработкиДокументов
где <Объект> - реквизит формы типа ДанныеФормыСтруктура, <ГруппаПроцесс> - имя добавленной группы формы (если параметр не указывать, то элементы библиотеки будут добавлены в конец формы в новую группу с именем ГруппаПроцесс), <ГруппаДляКнопкиПроцесс> – группа или имя группы, в которую будет добавлена кнопка «Процесс», открывающая карточку процесса документа.
По умолчанию команда «Процесс» размещается в панели навигации форм документов. Для форм документов, где такое расположение команды не подходит, необходимо в командном интерфейсе (Панель навигации - Перейти) форм отключить видимость команды ОбщаяКоманда.КарточкаПроцессаДокумента
•	В процедуру ПриЧтенииНаСервере (обработчик события формы) вставить вызов по шаблону:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриЧтенииНаСервере(ЭтотОбъект, ТекущийОбъект, <ГруппаПроцесс>, <ГруппаДляКнопкиПроцесс>);
// Конец ПроцессыОбработкиДокументов
•	В процедуру ПередЗаписьюНаСервере (обработчик события формы) вставить вызов по шаблону:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПередЗаписьюНаСервере(ЭтотОбъект, ТекущийОбъект, ПараметрыЗаписи, Отказ);
// Конец ПроцессыОбработкиДокументов
•	В процедуру ПослеЗаписиНаСервере (обработчик события формы) вставить вызов по шаблону:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПослеЗаписиНаСервере(ЭтотОбъект, ТекущийОбъект, ПараметрыЗаписи);
// Конец ПроцессыОбработкиДокументов
•	В процедуру ПередЗакрытием (обработчик события формы) вставить вызов по шаблону:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументовКлиент.ПередЗакрытием(ЭтотОбъект, <Объект>, Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка);
// Конец ПроцессыОбработкиДокументов
•	В модуль формы вставить процедуры:
// ПроцессыОбработкиДокументов
&НаКлиенте
Процедура Подключаемый_ВыполнитьЗадачуПоОбработкеДокумента(Команда)
  ПроцессыОбработкиДокументовКлиент.ВыполнитьЗадачу(ЭтотОбъект, Команда, <Объект>);
КонецПроцедуры
&НаКлиенте
Процедура Подключаемый_ВыполнитьЗадачуПоОбработкеДокументаОповещение(Контекст, ДополнительныеПараметры) Экспорт
  ВыполнитьЗадачуПоОбработкеДокументаНаСервере(Контекст);
  ВыполнитьОбработкуОповещения(ДополнительныеПараметры, Контекст);
КонецПроцедуры
&НаСервере
Процедура ВыполнитьЗадачуПоОбработкеДокументаНаСервере(Контекст)
  ПроцессыОбработкиДокументов.ВыполнитьЗадачу(ЭтотОбъект, Контекст, <Объект>);
КонецПроцедуры
&НаКлиенте
Процедура Подключаемый_КомментарийНаправившегоОткрытие(Элемент, СтандартнаяОбработка)
  ПроцессыОбработкиДокументовКлиент.КомментарийНаправившегоОткрытие(ЭтотОбъект, Элемент, СтандартнаяОбработка);
КонецПроцедуры
&НаКлиенте
Процедура Подключаемый_КомментарийСледующемуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
  ПроцессыОбработкиДокументовКлиент.КомментарийСледующемуНачалоВыбора(ЭтотОбъект, Элемент, ДанныеВыбора, СтандартнаяОбработка);
КонецПроцедуры
// Конец ПроцессыОбработкиДокументов
•	Если предполагается использование нескольких шаблонов для одного типа документа, то рекомендуется вызывать процедуры обновления видимости элементов подсистемы после изменения ключевых реквизитов (значения которых будут использоваться в условиях использования шаблонов)*:
•	для вызова с клиента (если нет серверного вызова):
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументовКлиент.ОбновитьРеквизитыПоШаблонуПроцесса(ЭтотОбъект);
// Конец ПроцессыОбработкиДокументов
•	для вызова с сервера (если уже делается серверный вызов):
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ВыполнитьЗадачу(ЭтотОбъект, "ОбновитьРеквизитыПоШаблонуПроцесса", <Объект>);
// Конец ПроцессыОбработкиДокументов
* - если предполагается, что ключевые реквизиты будут однозначно заданы до открытия формы нового документа и не смогут быть потом изменены, то добавление обработчиков не требуется.

28.	В формах списка и журналах документов, где требуется выводить информацию о текущем статусе, необходимо:
•	В процедуру ПриСозданииНаСервере (обработчик события формы) вставить вызов по шаблону:
// ПроцессыОбработкиДокументов
ПроцессыОбработкиДокументов.ПриСозданииНаСервереФормыСписка(ЭтотОбъект, <ДинамическийСписок>, <ИмяКолонки>, <ЗаголовокКолонки>, <ПоложениеКолонки>);
// Конец ПроцессыОбработкиДокументов
где <ДинамическийСписок> - строковое имя реквизита формы типа ДинамическийСписок, <ИмяКолонки> – (не обязателен, по умолчанию – «Статус») имя колонки статуса, не должно совпадать с другими именами полей динамического списка, <ЗаголовокКолонки> – (не обязателен, по умолчанию – «Статус») заголовок колонки с текущим статусом и пользовательское представление статуса в настройке динамического списка, <ПоложениеКолонки> – (не обязателен, по умолчанию – 0) индекс колонки таблицы значений, куда должна быть вставлена колонка со статусом.

29.	При наличии в конфигурации подсистемы «Миграция приложений» БТС в состав плана обмена Миграция приложений необходимо добавить все объекты библиотеки.

Особенности внедрения библиотеки в другие конфигурации
Бухгалтерия государственного учреждения, редакция 2
Начиная с версии 2.0.65 программный продукт «1С:Бухгалтерия государственного учреждения 8. Редакция 2» адаптирован для использования совместно с библиотекой «Процессы обработки документов», а именно выполнена часть настройки объектов конфигурации таким образом, что после первого внедрения библиотеки требуется выполнить только следующее:
•	П. 6-15, 24-26 и 29 раздела Настройка объектов конфигурации
•	П. 1 и 2 раздела Настройка интерфейса пользователя
Объекты библиотеки в пользовательском интерфейсе конфигурации по умолчанию располагаются в разделах:
•	Раздел Администрирование –> Органайзер –> группа Процессы обработки документов – флаг для включения функциональности библиотеки, форма управления функциональностью и настройкам библиотеки, справочники для настройки процессов.
•	Раздел Органайзер – списки Мои задачи по обработке документов и Назначение исполнителей

Зарплата и кадры государственного учреждения КОРП, редакция 3.1
Начиная с версии 3.1.10 программный продукт «1С:Зарплата и кадры государственного учреждения 8. Редакция 3» адаптирован для использования совместно с библиотекой «Процессы обработки документов», а именно выполнена часть настройки объектов конфигурации таким образом, что после первого внедрения библиотеки требуется выполнить только следующее:
•	П. 6-15, 24-26 и 29 раздела Настройка объектов конфигурации
•	П. 1 и 2 раздела Настройка интерфейса пользователя

1С:Бюджет поселения 8, редакция 1.3
Начиная с версии 1.3.21.34 программный продукт «1С:Бюджет поселения 8. Редакция 1.3» адаптирован для использования совместно с библиотекой «Процессы обработки документов», а именно выполнена часть настройки объектов конфигурации таким образом, что после первого внедрения библиотеки требуется выполнить только следующее:
•	П. 6-15, 24-26 и 29 раздела Настройка объектов конфигурации
•	П. 1 и 2 раздела Настройка интерфейса пользователя

Особые случаи обновления информационной базы
Появление составного типа для объектов адресации задач
Если обновление на очередной релиз прикладной конфигурации приводит к появлению составного типа в плане видов характеристик ОбъектыАдресацииЗадач, при том, что до обновления тип был не составным, то такая ситуация требует дополнительной обработки некоторых объектов библиотеки и конфигурации для сохранения работоспособности адресации задач, а именно в незаполненных реквизитах объектов типа Характеристика.ОбъектыАдресацииЗадач требуется установка значения Неопределено.
Для осуществления такой обработки требуется:
1.	Объект Задача.ЗадачаПоОбработкеДокумента включить в состав плана обмена ОбновлениеИнформационнойБазы с запретом авторегистрации
2.	В процедуру ПриДобавленииОбработчиковОбновления общего модуля ПроцессыОбработкиДокументовПереопределяемый необходимо вставить фрагмент кода;
ОбновлениеИнформационнойБазыПОД.ЗарегистрироватьОбработчикиОбновленияДляСоставногоТипаВОбъектахАдресацииЗадач(Обработчики, <Версия>);
где <Версия> - текущая установленная версия библиотеки «Процессы обработки документов» на момент обновления в виде строки, например, «1.0.8.1».
3.	При запуске информационной базы необходимо запустить выполнение обработчиков обновления. Для этого можно, например, предварительно понизить версию конфигурации и библиотеки в регистре сведений ВерсииПодсистем.

Настройка и использование библиотеки при разработке конфигурации
Настройка интерфейса пользователя
Библиотека «Процессы обработки документов» содержит формы, которые следует разместить в пользовательском интерфейсе.
1.	В командном интерфейсе программы необходимо разместить объекты:
•	Константа ИспользоватьПроцессыОбработкиДокументов – для включения/выключения функционала библиотеки (администраторами)
•	Команда НастройкиПроцессовОбработкиДокументов – для управления функциональностью и настройками библиотеки (ответственными за настройку процессов и администраторами)
•	Обработка ЗапускЭтапаПроцесса – для ручного запуска этапа процесса (администраторами)
•	Общая форма ПрерываниеВыполненияЗадач – для ручного прерывания процессов выполнения задач (администраторами)
•	Общая форма ДокументыСПроцессамиОбработки – для просмотра списка всех документов с процессами обработки, для групповй  выгрузки подписанных данных и печати реестра документов.
•	Справочники СтатусыДокументов, ЭтапыПроцессов, ШаблоныПроцессов – для настройки шаблонов процессов обработки документов (ответственными за настройку процессов и администраторами)
•	Общая команда МоиЗадачиПоОбработкеДокументов – для отображения списка задач пользователя и их выполнения (исполнителями задач)
•	Общая команда ЗадачиДляНазначенияИсполнителей – для контроля выполнения и назначения исполнителей задач (ответственными за контроль исполнения задач)
•	Общая команда ТекущиеРегламентныеИнтервалы – для контроля и изменения сроков выполнения регламентных интервалов (ответственными за контроль исполнения задач и кураторами регламентных интервалов)
•	Отчеты ЗадачиПоОбработкеДокументов и АнализВыполненияРегламентныхИнтервалов – для просмотра отчетов по задачам и регламентным интервалам (ответственными за контроль исполнения задач)
•	Документ ДополнительныеЗадания – для создания и просмотра дополнительных заданий (исполнителями задач)

2.	В рабочую область начальной страницы необходимо добавить форму МоиЗадачиДляРабочегоСтола задачи ЗадачаПоОбработкеДокумента и разместить ее на рабочем столе исполнителя задач для отображения списка своих задач и их выполнения.

Все объекты библиотеки используют управляемые формы. Для их корректного отображения в режиме обычного приложения следует установить флажок Использовать управляемые формы в обычном приложении в свойствах конфигурации.

Настройка прав пользователей
Для настройки прав доступа пользователей к данным подсистемы «Процессы обработки документов» следует использовать роли, приведенные ниже:
№	Роли и их назначение
1.		ПолныеПрава (из подсистемы БСП «Базовая функциональность»)
Включение и отключение использования подсистемы, выбор функциональности подсистемы, удаление помеченных на удаление объектов подсистемы.
2.		ДобавлениеИзменениеРолейИсполнителей (из подсистемы БСП «Бизнес-процессы и задачи»)
Добавление и изменение ролей исполнителей, объектов адресации. Изменение исполнителей ролей по объектам адресации.
3.		НастройкаПроцессовОбработкиДокументов
Добавление и изменение статусов, этапов, шаблонов процессов, регламентных интервалов. Изменение настроек подсистемы.
4.		ИзменениеВыполнениеЗадачПоОбработкеДокументов
Изменение и выполнение задач. Роль содержит тексты ограничений доступа, которые используют возможности подсистемы БСП «Управление доступом».
5.		ПросмотрПроцессовОбработкиДокументов
Просмотр статусов и задач документов. Роль содержит тексты ограничений доступа, которые используют возможности подсистемы БСП «Управление доступом».
6.		ОтменаПринятияКИсполнениюЗадачПоОбработкеДокументов
Возможность отмены принятия к исполнению любых задач по обработке документов. Предназначена для того чтобы не предоставлять отдельным пользователям полные права для отмены принятия к исполнению любых задач. Рекомендуется добавлять отдельные дополнительные профили групп доступа с этой ролью.
7.		ОтменаВыполненияЗадачПоОбработкеДокументов
Возможность отмены выполнения любых задач по обработке документов. Предназначена для того чтобы не предоставлять отдельным пользователям полные права для отмены выполнения любых задач. Рекомендуется добавлять отдельные дополнительные профили групп доступа с этой ролью.

Настройка обмена данными
Все объекты метаданных библиотеки, содержащие данные, рекомендуется включать в планы обмена распределенной информационной базы.

Программный интерфейс
В разделе приводится описание методов переопределяемых модулей с примерами использования. Подробное описание методов и их параметров приведено в комментариях к процедурам и функциям.
Общий модуль ПроцессыОбработкиДокументовПереопределяемый, переопределяемые процедуры и функции
1.	Процедура ПриЗаполненииДереваЗонОтветственности – выполняется при заполнении дерева реквизитов при настройке зон ответственности этапа шаблона процесса. Здесь можно добавить в дерево новые элементы ответственности, присвоив им строковые идентификаторы. В дальнейшем по этим идентификаторам можно управлять доступностью элементов форм, контролировать их изменение, включать эти данные в состав подписываемых с помощью электронной подписи. Примеры использования:
•	В форму документа выводятся некоторые связанные с документом данные, не являющиеся реквизитами документа, но для которых необходимо настроить ответственность, доступность, обязательность заполнения наряду с типовыми реквизитами документа.
•	Некоторые данные документа хранятся в реквизите с типом ХранилищеЗначения, и, соответственно, реквизита с таким типом в форме нет, но есть некоторое представление этих данных, например, в виде табличного документа. Требуется обозначить эту область данных некоторым именем для дальнейшей идентификации в других переопределяемых методах.
2.	Процедура УправлениеДоступностьюРеквизитовСогласноШаблону – выполняется при инициализации формы документа. В процедуре можно управлять доступностью элементов. В процедуре можно анализировать идентификаторы зон ответственности, присвоенные в методе ПриЗаполненииДереваЗонОтветственности. Пример использования:
•	Необходимо запретить интерактивное изменение элемента (или нескольких) формы, содержащего некоторое значение, не связанное с метаданными документа.
3.	Процедура ЗначениеРеквизитовОбъектаПоСоставу – выполняется при получении данных документа для включения в подписываемые электронной подписью данные либо при проверке электронной подписи. В процедуре можно включить в состав подписываемых данных некоторую прикладную информацию. В процедуре можно анализировать идентификаторы зон ответственности, присвоенные в методе ПриЗаполненииДереваЗонОтветственности. Пример использования:
•	В состав подписываемых с помощью электронной подписи данных необходимо включить некоторые связанные данные, не являющиеся реквизитами документа.
4.	Процедура ПриКонтролеИзмененияРеквизитов – выполняется при контроле недоступных для изменения данных перед записью документа. В процедуре необходимо описать алгоритм проверки элементов ответственности, добавленных в методе ПриЗаполненииДереваЗонОтветственности. Пример использования:
•	Необходимо проконтролировать, что пользователь не изменил некоторые данные, не являющиеся реквизитами документа.
5.	Процедура ПриПроверкеЗаполненияОбязательныхРеквизитов – выполняется при проверке заполнения обязательных реквизитов перед выполнением этапа. В процедуре можно анализировать идентификаторы зон ответственности, присвоенные в методе ПриЗаполненииДереваЗонОтветственности. Пример использования:
•	Необходимо проконтролировать, заполнен ли реквизит формы документа, не являющийся реквизитом документа.
6.	Процедура ПриСозданииНаСервереФормыНовогоДокумента – выполняется при создании на сервере формы нового документа до выполнения обработчиков библиотеки. В процедуре имеется возможность отказаться от стандартной обработки события. Пример использования:
•	Необходимо для нового документа отказаться от обработки документа при помощи функционала библиотеки.
7.	Процедура ПриИнициализацииФормыДокумента – выполняется при инициализации формы документа – предмета обработки. Вызов процедуры производится при создании/чтении/перечитывании объекта, при выполнении команд выполнения этапа или принятия к исполнению задачи из формы документа, когда производится переинициализация элементов и команд формы. Нужна для переопределения стандартной инициализации формы документа. Примеры использования:
•	На форму документа, подлежащего обработке, необходимо вывести информацию о дате создания задачи по его обработке.
•	Требуется изменить цветовое оформление кнопок с результатами выполнения задач.
•	На форму документа не требуется выводить текущий статус документа.
8.	Процедура ПриВыполненииЗадачи – вызывается в конце транзакции выполнения задачи по обработке документа. Пример использования:
•	После успешного выполнения задачи необходимо отправить сообщение о ее выполнении некоторому веб-сервису.
9.	Процедура ПриНеуспешномВыполненииЗадачи – вызывается при неуспешной попытке выполнить задачу по обработке документа в блоке обработки исключения. Пример использования:
•	После неуспешного выполнения задачи необходимо сохранить информацию об ошибке выполнения в комментарии документа.
10.	Функция ПользовательМожетБытьИсполнителем – выполняется при определении возможности выполнения этапа пользователем. В функции можно отказаться от стандартной проверки и описать свой алгоритм. Пример использования:
•	Пользователь не может быть исполнителем этапа, если он использует пустой пароль при аутентификации в 1С.
11.	Процедура ПриПроверкеПраваПринятияКИсполнениюЗадачи – выполняется при определении возможности принятия задачи к исполнению пользователем. В процедуре можно отказаться от стандартной проверки и разрешить или запретить принятие задачи к исполнению. Пример использования:
•	Пользователь не может принять задачу к исполнению, при определенном значении какого-либо реквизита документа.
12.	Процедура ПриПроверкеПраваОтменыПринятияКИсполнениюЗадачи – выполняется при определении возможности отмены принятия к исполнению задачи пользователем. В процедуре можно отказаться от стандартной проверки и разрешить или запретить отмену принятия к исполнению задачи. Пример использования:
•	Пользователь может отменить принятие к исполнению задачи другого пользователя, если он является его руководителем.
•	Пользователь не может отменить принятие к исполнению задачи ни при каких условиях.
13.	Процедура ПриПроверкеПраваОтменыВыполненияЗадачи – выполняется при определении возможности отмены выполнения задачи пользователем. В процедуре можно отказаться от стандартной проверки и разрешить или запретить отмену выполнения задачи. Пример использования:
•	Пользователь может отменить выполнение задачи другого пользователя, если он является его руководителем.
•	Пользователь не может отменить выполнение задач некоторых этапов, которые считаются «не обратимыми».
14.	Процедура ПриОпределенииРеквизитовАдресации – выполняется при создании задачи по обработке документа. В процедуре можно отказаться от стандартного определения реквизитов адресации создаваемой задачи и описать свой алгоритм. Пример использования:
•	Для документов типа «Расходное расписание» задачу последнего этапа требуется адресовать бухгалтеру, указанному в реквизите документа «Ответственный»
15.	Процедура ПередЗаписьюДокумента – выполняется перед записью документа – предмета процесса обработки. Пример использования:
•	Перед записью нового документа необходимо заполнить некоторый реквизит, который определит выбор шаблона процесса.
•	При записи некоторых документов не требуется выполнять стандартную обработку события ПередЗаписью
16.	Процедура ОписаниеДополнительныхКомандКарточкиПроцессаДокумента – позволяет описать дополнительные команды, которые будут доступны для выполнения в общей форме «КарточкаПроцессаДокумента». Коды обработчиков команд должны быть описаны в виде процедур в общем переопределяемом модуле ПроцессыОбработкиДокументовПереопределяемый или ПроцессыОбработкиДокументовКлиентПереопределяемый в зависимости от места выполнения команды (сервер или клиент).
17.	Процедура ИзменитьВремяОжиданияВыполненияЗадачи – позволяет изменить время (длительность) ожидания выполнения задачи, по прошествии которого задача и задачи из этой же пачки должны быть отмечены как невыполняемые. Время по умолчанию – 1 час.
18.	Процедура ОписаниеСобытийИнициирующихВыполнениеЭтапов – позволяет перечислить именованные события прикладной конфигурации, доступные для выбора в шаблонах процессов в качестве инициирующих выполнение этапов. Идентификатор события используется в качестве параметра экспортного метода ПроцессыОбработкиДокументов.ВыполнитьЗадачиПоСобытию
19.	Процедура ОписаниеФункцийПоискаЗависимыхОбъектов – позволяет описать дополнительные функции, которые впоследствии могут быть указаны в шаблонах процессов в настройке влияния на процессы в качестве связи с зависимыми объектами. Дополнительные функции используются для поиска зависимых объектов по ссылке на влияющий объект и могут понадобиться, когда влияющий объект не содержит в своих метаданных прямых ссылок на зависимые объекты. Коды функций должны быть описаны в общем переопределяемом модуле ПроцессыОбработкиДокументовПереопределяемый
20.	Процедура ОписаниеФункцийОпределенияИсполнителейЭтапа – позволяет описать дополнительные функции, которые впоследствии могут быть указаны в шаблонах процессов в качестве исполнителей этапов. Дополнительные функции используются для определения исполнителей этапа и могут понадобиться, когда исполнителей невозможно определить другим стандартным функционалом библиотеки. Коды функций должны быть описаны в общем переопределяемом модуле ПроцессыОбработкиДокументовПереопределяемый
21.	Процедура ПриСозданииНаСервереФормыНастроек – выполняется при создании на сервере формы настроек библиотеки. Позволяет внести изменения в форму настроек, например, добавить свои настройки или скрыть типовые.
22.	Процедура ПриОпределенииГрафикаРаботыИсполнителя – позволяет отказаться от стандартного функционала библиотеки по определению графика работы исполнителя, а также подготовить данные для последующего использования в переопределяемых функциях ДатаПоГрафику и РасписаниеРаботыНаПериод.
23.	Функция ДатаПоГрафику – возвращает дату, которая отличается от указанной даты на указанное количество рабочих дней.
24.	Функция РасписаниеРаботыНаПериод – позволяет указать расписание работы за указанный период, которое будет использоваться при расчете времени и сроков выполнения этапов процессов.
25.	Процедура ПриОпределенииШаблонаИСтатусаНовогоДокумента – позволяет отказаться от стандартного функционала библиотеки по определению шаблона процесса для обработки нового документа и указать свой шаблон процесса.
26.	Функция РегламентныйИнтервалДляЗапуска – позволяет отказаться от стандартного функционала библиотеки по определению регламентного интервала для запуска и указать свой регламентный интервал.
27.	Процедура ПриПечати – выполняется после формирования табличного документа в менеджере печати объекта, но до одноименной процедуры библиотеки с добавлением штампов визуализации электронной подписи. В процедуре имеется возможность отказаться от стандартной обработки события.
28.	Процедура ЗаполнитьСведенияОПользователе – выполняется при подготовке данных перед подписанием простой электронной подписью. В процедуре необходимо заполнить сведения о полном имени, организации и должности подписанта для последующей записи этой информации в свойства электронной подписи.
29.	Процедура ПередЗаписьюПрисоединенногоФайла – выполняется перед записью присоединенного к документу файла. В процедуре можно отказаться от стандартной логики ограничения записи присоединенных файлов и описать свой алгоритм. Пример использования:
•	Файл необходимо записать независимо от логики процесса обработки документа
30.	Процедура ПередЗапускомПрерываниемСледующихЭтапов – выполняется в транзакции выполнения задачи после ее записи, но до выполнения запуска и прерывания других задач по шаблону процесса. Процедуру можно использовать для ручного запуска и/или прерывания задач.
31.	Процедура ПриВыгрузкеШаблоновПроцессов – выполняется при подготовке файла данных при выгрузке шаблонов процессов в обработке «Импорт / экспорт шаблонов процессов». В процедуре можно дополнить xml-файл с выгружаемыми данными произвольной информацией, которая в дальнейшем может быть прочитана при загрузке шаблонов процессов методом ПроцессыОбработкиДокументовПереопределяемый.ПриЗагрузкеШаблоновПроцессов.
32.	Процедура ПриЗагрузкеШаблоновПроцессов – выполняется при загрузке шаблонов процессов в обработке «Импорт / экспорт шаблонов процессов» в той же транзакции. Позволяет дополнительно обработать загружаемую информацию, в том числе добавленную методом ПроцессыОбработкиДокументовПереопределяемый.ПриВыгрузкеШаблоновПроцессов.
33.	Процедура ПриЗаполненииТаблицыИсключенийПервичныхДокументов – определяет перечень печатных форм документов учета, которые следует исключить из доступных для настроек списка первичных документов на закладке «Первичные документы» настройки зоны ответственности этапов шаблона процесса.
34.	Процедура ДополнительныеПроверкиПередЗаписьюДокумента – выполняется из процедуры "ПередЗаписьюДокумента" общего модуля "ПроцессыОбработкиДокументов".
35.	Процедура РежимФормированияИПодписанияФормуляров определяет видимость настроек формирования и подписания формуляров первичных документов в прикладном решении.
36.	Функция НаименованиеФайлаФормуляра определяет алгоритм наименования файлов формуляров;
37.	Функция НомерДляПечати определяет номер формуляра по данным номера документа учета и настройкам префиксации.
38.	Функция ОтображатьДатуПодписанияВШтампе – вызывается для проверки необходимости отображения даты подписания в штампе электронной подписи.
39.	Функция УстановленныеПодписиДляФормуляраПОД определяет список установленных подписей для формуляра.
40.	Процедура ДополнительныеПроверкиПередЗаписьюДокумента вызывается из процедуры ПередЗаписьюДокумента общего модуля ПроцессыОбработкиДокументов, выполняется перед записью документа - предмета процесса обработки.
41.	Процедура ЗаполнитьРеквизитыДокументаУчета позволяет заполнить ключевые реквизиты документа учета для целей формирования формуляра первичного документа.
42.	Процедура НаименованиеПечатнойФормыПоИдентификаторуПечати позволяет определить наименование печатной формы для целей формирования формуляра первичного документа.
43.	Процедура РезультатПечатиПредставленияДокумента – определяется в случае необходимости сформировать двоичные данные файла формуляра по специальному алгоритму формирования.
44.	Процедура ФормулярЭлектронныйДокументОбработкаЗаполнения - Вызывается в событии "ОбработкаЗаполнения" документа "ФормулярПервичногоДокументаПОД".

Общий модуль ПроцессыОбработкиДокументовКлиентПереопределяемый, переопределяемые процедуры и функции
1.	Процедура ПриВыбореИсполнителя – вызывается при открытии формы выбора исполнителя при настройке исполнителей этапов в шаблонах процессов. Позволяет переопределить стандартную форму выбора. Примеры использования:
•	В организации не используется прямая адресация, необходимо предоставлять для выбора только список ролей исполнителей
•	Вместо стандартной формы выбора исполнителя этапа необходимо использовать другую форму конфигурации.
2.	Процедура ПриПодготовкеДанныхДляПодписиДокумента – вызывается после подготовки данных для электронной подписи документа, но перед вызовом окна подписания. Пример использования:
•	Необходимо переопределить представление подписываемых данных при интерактивном нажатии на гиперссылку в форме подписи.
3.	Процедура ПередВыполнениемЗадач – вызывается при выполнении задач до начала транзакции и до вызова окна подписания электронной подписью. В процедуре можно установить отказ от дальнейшего выполнения задач. Пример использования:
•	При выполнении задачи требуется интерактивное действие пользователя.
4. Процедура ДополнительныеНастройкиОтображенияДатыПодписания – вызывается из формы общих настроек процессов обработки документов.
5. Процедура ПередНачаломВыполненияЗадачи – вызывается перед началом выполнения задач.
Подключаемые обработчики
Если при выполнении этапов по обработке документа необходимо выполнять некоторую прикладную логику на клиенте или на сервере, то данные алгоритмы можно описать в виде дополнительных обработчиков-процедур в переопределяемых модулях ПроцессыОбработкиДокументовОбработчикиПереопределяемый и ПроцессыОбработкиДокументовКлиентОбработчикиПереопределяемый и в дальнейшем подключить их к конкретным шаблонам процессов в режиме «1С:Предприятие».
Схема описания дополнительных обработчиков в переопределяемых модулях выглядит следующим образом:
1.	В процедуру ОписаниеДополнительныхОбработчиков добавляется описание дополнительного обработчика. Пример кода:
НовыйОбработчик = Новый Структура;
НовыйОбработчик.Вставить("Идентификатор", "КонтрольРасходов");
НовыйОбработчик.Вставить("Представление", НСтр("ru = ‘Контроль расходов’"));
НовыйОбработчик.Вставить("ОбъектыМетаданых", "Документ.ЗаявкаНаКассовыйРасход
            |Документ.ПлатежноеПоручение");
МассивОбработчиков.Добавить(НовыйОбработчик);
2.	В модуль добавляется процедура по имени идентификатора. Пример кода:
Процедура КонтрольРасходов(Параметры)
  КонтрольРасходов.Контроль(Параметры.Источник, Параметры.Отказ);
КонецПроцедуры
По точке вызова дополнительные обработчики делятся на три типа:
1.	Клиентские обработчики – выполняются на клиенте после подписания документа электронной подписью (если используется), но до запуска транзакции выполнения этапа. В данных обработчиках можно выполнить некоторый алгоритм, требующий интерактивных действий пользователя, например, выгрузить данные в файл или задать вопрос и обработать результат.
2.	Серверные обработчики «до транзакции» – выполняются в режиме вызова сервера до начала транзакции выполнения этапа и до осуществления электронной подписи (если используется). Данные обработчики рекомендуется использовать для выполнения некоторых проверок корректности заполнения документа и/или связанных данных с возможностью установки отказа от дальнейшего выполнения этапа. Обработчики данного типа могут предполагать групповую обработку списка документов.
3.	Серверные обработчики «в транзакции» – выполняются в одной транзакции с выполнением этапа. Данные обработчики рекомендуется использовать для выполнения некоторых транзакционных действий, связанных с выполнением этапа, например, синхронная запись вспомогательных данных.
Полное описание порядка объявления и разработки процедур дополнительных обработчиков приведено в комментариях к указанным общим модулям.

Инициирующие события
Если требуется организовать автоматическое выполнение этапов бизнес-процессов при выполнении некоторых событий прикладной логики, то для этого можно воспользоваться механизмом инициирующих событий. Например, можно автоматически выполнить этап бизнес-процесса одновременно с проведением документа или при выполнении обмена данными без использования кнопок выполнения этапов. Аналогично есть возможность отмены выполнения указанных этапов также по событиям прикладной логики.
Общая схема описания и использования инициирующих событий:
1.	В процедуре ОписаниеСобытийИнициирующихВыполнениеЭтапов общего модуля ПроцессыОбработкиДокументовОбработчикиПереопределяемый добавляется описание события. Пример кода:
  Событие = Новый Структура;
  Событие.Вставить("Идентификатор", "ОтправкаФайлов");
  Событие.Вставить("Представление", НСтр("ru = 'Отправка файлов экспорта'"));
  Событие.Вставить("Описание", НСтр("ru = 'Возникает при отправке файлов экспорта по кнопке ""Отправить файлы""'"));
  Событие.Вставить("ОбъектыМетаданных", "Документ.ЗаданиеНаЭкспортДанныхВБанкиКС");

  События.Добавить(Событие);
2.	В серверном методе необходимого события прикладной конфигурации размещается вызов метода ПроцессыОбработкиДокументовОбработчики.ВыполнитьЗадачиПоСобытию с передачей объекта и идентификатора события. Пример кода:
&НаСервере
Процедура ВыгрузитьФайлы()
  ПроцессыОбработкиДокументов.ВыполнитьЗадачиПоСобытию(Объект.Ссылка, "ОтправкаФайлов");
КонецПроцедуры
3.	В шаблоне процесса в форме настройки дополнительных обработчиков и событий для одного из результатов выполнения этапа необходимо выбрать соответствующее событие.

4.	Если по какому-либо действию прикладной конфигурации требуется выполнить отмену выполнения этапа, ранее выполненного по инициирующему событию, то в серверном методе прикладной конфигурации необходимо разместить метод ПроцессыОбработкиДокументовОбработчики.ОтменитьВыполнениеЗадачиПоСобытию

Специальные ключи параметра ДополнительныеСвойства в обработчике ПередЗаписью
Библиотека накладывает ряд ограничений на запись документа в обработчике события Перед записью, связанных с логикой разграничения доступа исполнителей к выполнению задач, правилами, настроенными в шаблоне процесса обработки документа, и т.д. При невыполнении одного из ограничений в событии будет выставлен признак Отказ = Истина, и документ не будет записан. Однако в ряде случаев бизнес-логикой могут предъявляться требования к обходу части этих ограничений при выполнении записи документа. Для этих целей в библиотеке предусмотрены специальные ключи свойства ДополнительныеСвойства объекта, анализируемые в обработчике Перед записью:
•	ПроцессыОбработкиДокументов_НеЗаписыватьДокумент – документ не будет записан в любом случае.
•	ПроцессыОбработкиДокументов_ЗаписатьБезПроверки – не будут выполняться никакие проверки, для новых документов не будет выполнен запуск стартового этапа шаблона процесса.
•	ПроцессыОбработкиДокументов_ЗаписатьБезПроверкиЗапущенногоПроцессаВыполнения – не будет выполняться проверка наличия запущенных процессов по выполнению задачи по обработке документа.
•	ПроцессыОбработкиДокументов_ЗаписатьБезПроверкиИсполнителяЭтапа – не будет выполняться проверка прав текущего пользователя на запись нового документа.
•	ПроцессыОбработкиДокументов_ЗаписатьБезПроверкиТребованийКПроведению – не будет выполняться проверка требований к проведению документа.
•	ПроцессыОбработкиДокументов_ЗаписатьБезПроверкиОбменДаннымиЗагрузка – будет проигнорирован признак ОбменДанными.Загрузка = Истина, и код обработчика события будет выполнен, а именно будет проверена возможность записи документа, а для новых документов будет выполнен запуск стартового этапа шаблона процесса (если документу назначен шаблон процесса).
В обработчике анализируется только наличие свойства параметра ДополнительныеСвойства с определенным ключом, значение свойства не анализируется.

Пользовательская документация
Настройки программы
Для использования функционала библиотеки необходимо включить константу ИспользоватьПроцессыОбработкиДокументов
Для управление функциональностью и настройками библиотеки предназначена панель настроек Настройки процессов обработки.




Описание настроек библиотеки «Процессы обработки документов»:
•	Усиленная подпись – управление возможностью использовать усиленную электронную подпись при выполнении этапов и выводить штамп визуализации электронной подписи в печатных формах документов.
Внимание: данная настройка доступна для включения при использовании функциональности Электронная подпись, для управления которой необходимо перейти в форму настроек по команде Общие настройки раздела Администрирование
•	Простая подпись – управление возможностью использовать простую электронную подпись и выводить штамп визуализации электронной подписи в печатных формах документов.
•	Отображать дату подписания в штампе визуализации электронной подписи – управление отображением даты подписания в штампах визуализации простых и усиленных электронных подписей в печатных формах документов
•	Подпись присоединенных файлов – управление необходимостью подписывать присоединенные к документу файлы при выполнении этапа с созданием усиленной электронной подписи. Режим подписи файлов выбирается при помощи переключателя:
•	настраивается в шаблоне – необходимость подписи присоединенных файлов настраивается в шаблонах процессов документов отдельно для каждого этапа процесса;
•	выполняется всегда – присоединенные файлы подписываются всегда, настройка в шаблоне процесса не отображается.
•	Проверить электронные подписи средствами криптопровайдера – управляет необходимостью проверять все ранее созданные усиленные подписи средствами программы электронной подписи и шифрования (криптопровайдер) при выполнении очередного этапа с созданием электронной подписи.
•	Проверить соответствие ранее подписанных и текущих данных документа – управляет необходимостью сверки данных, ранее подписанных электронной подписью, и текущих данных документа при выполнении очередного этапа с созданием электронной подписи.
•	Проверить наличие ключа простой электронной подписи в реестре – управляет необходимостью проверки у пользователя наличия действующего ключа простой электронной подписи в реестре ключей простой электронной подписи при выполнении им этапа процесса с созданием простой электронной подписи.
•	Реестр ключей простых электронных подписей – список ключей простых электронных подписей
•	Проверить заполнение должности подписанта при использовании простой электронной подписи – включает проверку обязательного наличия должности у пользователя, который подписывает документ простой электронной подписью.
•	Настройка подписи ссылочных данных – настройка состава реквизитов ссылочных данных для включения в состав подписываемых данных при помощи электронной подписи.
•	Использовать графики работы – для расчета сроков и фактического времени выполнения задач используются графики работы.
•	Основной график работы – график работы, используемый по умолчанию, для расчета сроков и фактического времени выполнения задач.
Внимание: Основной график работы доступен для выбора только при наличии подсистемы БСП «Графики работы». Порядок настройки графиков работы описан в пользовательской документации БСП.
•	Регламентные интервалы – управление возможностью создания и использования регламентных интервалов – последовательностей этапов процесса с целью контроля их общего срока выполнения.
•	Напоминать о приближении срока выполнения задач за – позволяет указать время до наступления срока выполнения задач, за которое необходимо предупредить исполнителя о наличии невыполненной задачи. Предупреждение выражается в изменении цвета срока выполнения в формах списков задач.
•	Использовать несколько шаблонов для одного типа документа – управление возможностью использовать несколько шаблонов процессов для одного типа документа. Выбор конкретного шаблона осуществляется в зависимости от заданного условия использования шаблона, составленного по ключевым реквизитам документа.
•	Разрешить запись документа без шаблона, если ни один шаблон не подходит по условиям использования – разрешает записывать документ без назначения ему шаблона процесса, если для этого типа документа установлено использование шаблонов процессов с указанием условий их использования, но при этом ни один из шаблонов не подходит для конкретного документа.
•	Разрешить редактирование документа до принятия задачи к исполнению – при наличии нескольких исполнителей роли для редактирования реквизитов документов не требуется предварительное принятие задачи к исполнению.
•	Не заполнять комментарий при выполнении этапа с отрицательным результатом – разрешает не указывать причину при выполнении этапа с отрицательным результатом выполнения.
•	Проверять наличие исполнителей перед запуском этапа – включает проверку перед запуском следующего этапа наличия исполнителя для роли, указанной в параметрах следующего этапа. Если указанной в следующем этапе роли не соответствует ни одного исполнителя, переход к следующему этапу не выполняется.
•	Запретить исполнителям отмену выполненных этапов – включает общий запрет исполнителям на отмену выполненных ими этапов.
•	Уведомлять исполнителей о новых задачах по почте – позволяет рассылать по почте уведомления исполнителям о новых задачах. После включения флажка становится активной гиперссылка с настройкой расписания рассылки сообщений о новых задачах.
Письма будут отправляться по адресам, указанным в контактной информации пользователей (подробнее см. пользовательскую документацию БСП к подсистеме «Пользователи»). Рассылка осуществляется от системной учетной записи, настройка которой описана в документации БСП к подсистеме «Работа с почтовыми сообщениями». По гиперссылке «Исключения уведомлений по ролям» может быть задан список ролей исполнителей, для которых не требуется отправка уведомлений. По гиперссылке «Исключения уведомлений по пользователям» может быть задан список пользователей, для которых не требуется отправка уведомлений.
•	Роли исполнителей – настройка ролей исполнителей для использования ролевой адресации задач. Настройка производится согласно настройке ролевой адресации подсистемы БСП «Бизнес-процессы и задачи».
•	Настройка использования шаблонов – настройка правил использования шаблонов процессов для конкретных типов документов.
•	Настройка прав назначения исполнителей – управление настройками прав назначения исполнителей. Настройка позволяет указать для роли исполнителей определенного пользователя/роль, имеющего право персонально назначать конкретных исполнителей из этой роли исполнителей для выполнения задач по обработке документов.
•	Настройка передачи прав исполнителей – настройка временной передачи прав исполнителей по отмене выполнения и отмене принятия к исполнению задач
•	Дополнительные колонки списков задач – настройка дополнительных колонок списков задач и управление их отображением в списках задач исполнителей.

Настройка ограничений доступа
Для разграничения доступа к задачам по обработке документов библиотека использует предопределенный вид доступа Пользователи из подсистемы БСП Управление доступом, поэтому для используемых профилей групп доступа, включающих роли ИзменениеВыполнениеЗадачПоОбработкеДокументов или ПросмотрПроцессовОбработкиДокументов, необходимо добавить ограничение доступа Пользователи.


Производительный вариант работы ограничения доступа
При использовании производительного варианта работы ограничения доступа на уровне записей библиотека ограничивает права доступа к задачам в зависимости от прав на обрабатываемые документы. При этом роли ИзменениеВыполнениеЗадачПоОбработкеДокументов и ПросмотрПроцессовОбработкиДокументов предоставляют право доступа к задачам с использованием условия-функции ЧтениеОбъектаРазрешено в логике ограничения доступа, где "объект" – это обрабатываемый документ, поэтому эти роли следует включить в те же профили, что предоставляют права доступа к самим документам.

Стандартный вариант работы ограничения доступа
При использовании стандартного варианта работы ограничения доступа на уровне записей библиотека не ограничивает права доступа к задачам в зависимости от прав на обрабатываемые документы. Роли ИзменениеВыполнениеЗадачПоОбработкеДокументов и ПросмотрПроцессовОбработкиДокументов не обязательно включать в другие профили.

Создание шаблонов процессов
Библиотека «Процессы обработки документов» позволяет создавать собственные правила поэтапной обработки документов в виде преднастроенных шаблонов процессов обработки документов.
Пример шаблона процесса, который может быть создан при помощи библиотеки:

Описание элементов схемы шаблона процесса:
•	Шаблон состоит из этапов – фрагментов бизнес-процесса, в ходе которого ответственный за выполнение этапа выполняет свою функцию по обработке документа.
•	При переходе бизнес-процесса к очередному этапу, формируется задача исполнителю этапа.
•	Каждый этап может быть выполнен с определенным результатом, который определяет дальнейший ход процесса и может изменить статус документа.
•	Задачи могут быть адресованы исполнителю или группе исполнителей как персонально (персональная адресация), так и с использованием ролей (ролевая адресация).
•	Для шаблона процесса могут быть заданы влияющие и зависимые этапы других шаблонов. Зависимый этап – это этап другого шаблона, который автоматически выполняется при выполнении этапа  исходного шаблона. Влияющий этап – это этап другого процесса, выполнение которого автоматически выполняет этап исходного шаблона.

Рассмотрим подробнее порядок создания шаблона процесса.
Справочник Статусы документов
Справочник Статусы документов содержит перечень наименований статусов документов, применяемых в организации для обозначения условных состояний документов в процессе их обработки.

В форме элемента справочника необходимо заполнить реквизиты:
•	Наименование – представление статуса для отображения в формах, списках документов, при настройке шаблонов.

Справочник Этапы процессов
Справочник Этапы процессов содержит набор этапов, из которых будут составляться шаблоны процессов.

Этап представляет собой некоторое действие, которое должно быть выполнено при обработке документа. Этап процесса обработки документа определяет задачу исполнителя, которая будет ему адресована для выполнения.

В форме элемента справочника Этап процесса необходимо заполнить реквизиты:
•	Наименование – наименование этапа, определяет имена задач исполнителям;
•	Описание – подробное описание этапа для исполнителя
•	Комментарий служебный – произвольная информация об этапе процесса для дополнительной идентификации в формах списка и выбора.
В табличной части Результаты выполнения необходимо заполнить возможные результаты, с которыми этап может быть выполнен. Состав этой табличной части будет определять состав кнопок с командами выполнения этапа. Для каждого результата выполнения заполняются реквизиты:
•	Представление – представление результата выполнения этапа. Значение реквизита определяет заголовок кнопки-команды, которая будет выведена на форму.
•	Статус после выполнения – статус документа, который должен быть установлен при выполнении этапа с данным результатом. Если выполнение этапа не предполагает изменение статуса документа, то реквизит не заполняется.
•	Отрицательный – характер результата. Значение реквизита влияет на цвет кнопки с командой выполнения этапа: положительные результаты отображаются зеленым цветом, а отрицательные – красным.
Кроме этого, выбор отрицательного результата влияет на поведение программы:
•	будет запрошен обязательный ввод комментария с указанием причины выбора такого результата;
•	не выполняется проверка обязательности заполнения реквизитов;
•	Требуется ЭП (усиленная / простая) – для выполнения этапа с данным результатом требуется подписать документ с помощью усиленной либо простой электронной подписи.
•	Скрытый – кнопка с командой выполнения этапа не будет выводиться на форму документа и на форму списка задач. Таким образом, у исполнителя не будет возможности выполнить этап процесса интерактивно. Использование скрытых результатов может быть востребовано, если требуется выполнять этап только через настройку влияния либо только по инициирующему событию прикладной конфигурации.

Справочник Шаблоны процессов
Справочник Шаблоны процессов представляет собой перечень правил обработки документов.

С помощью настройки Показывать шаблоны может быть задано отображение в списке всех существующих шаблонов или только используемых. Если задано отображение всех шаблонов, то шаблоны с установленным признаком Не используется выделяются в списке серым цветом.
В форме списка шаблонов процессов помимо стандартных команд управления списком элементов расположено подменю Администрирование, содержащее команды Импорт / экспорт шаблонов процессов, и Проверить корректность шаблонов. 
С помощью команды Импорт / экспорт шаблонов процессов выполняется открытие одноименной обработки, предназначенной для обмена шаблонами процессов между однотипными конфигурациями (например, между областями «облачной» информационной базы). Подробное описание механизма приведено в разделе Импорт / экспорт шаблонов процессов.

С помощью команды Проверить корректность шаблонов выполняется открытие формы проверки настроек процессов обработки.


В форме проверки на закладке Проверка шаблонов с помощью команды Найти шаблоны с ошибками выполняется поиск ошибочных шаблонов, при этом в список добавляются все шаблоны, содержащие ошибочные данные. Описание найденных ошибок отображается в колонке Текст ошибки.
На закладке Проверка настроек ссылочных данных аналогичным способом может быть выполнена проверка настроек подписи ссылочных данных.

В форме элемента справочника необходимо заполнить реквизиты:
•	Тип документа – тип документа, для обработки которого предназначен шаблон. Выбирается из справочника Идентификаторы объектов метаданных.
•	Не используется – признак неиспользуемого шаблона, который не будет отображаться в списках выбора
•	Наименование – наименование шаблона.
•	Начальный статус – статус, который будет присвоен документу при его создании.
•	Описание – произвольная информация о шаблоне процесса для дополнительной идентификации в формах списка и выбора.
На закладке Этапы в табличной части необходимо заполнить перечень этапов обработки документа, через которые он должен пройти согласно настраиваемому шаблону. Порядок этапов в табличной части не имеет значения, но рекомендуется их заполнять в порядке реального следования для облегчения читаемости настроек шаблона. В табличной части заполняются следующие данные:
•	Этап – этап процесса;
•	Исполнитель – исполнитель этапа процесса.

При выборе исполнителя будет открыта форма Выбор исполнителя этапа, где в качестве исполнителя этапа можно выбрать:
•	Пользователя из справочника Пользователи – при прямой адресации;
•	Роль исполнителя из справочника Роли и исполнители задач – при ролевой адресации;
•	Автор документа (предопределенное значение).
•	Дополнительная функция – если исполнитель должен быть определен при помощи функции, предварительно описанной в процедуре ПроцессыОбработкиДокументовПереопределяемый.ОписаниеФункцийОпределенияИсполнителейЭтапа. Выбор дополнительной функции выполняется с помощью предопределенного элемента Дополнительная функция из списка ролей исполнителей.

•	Пользователь, указанный в реквизите – для прямой адресации исполнителю, указанному в реквизите документа. Данный способ адресации может применяться только для реквизитов с типом значения – справочник Пользователи.

Если выбранная роль может назначаться исполнителям с уточнением по объекту адресации, то при выборе роли будет предложено указать одно из двух правил определения основного и дополнительного объектов адресации:
•	Значением – объект адресации выбирается непосредственно из справочника соответствующего типа;
•	Реквизитом документа – объект адресации определяется с учетом значения определенного реквизита документа на момент создания задачи исполнителю этапа. При выборе этого правила будет предложено указать имя реквизита документа, по которому следует определить объект адресации. При этом список допустимых имен реквизитов будет ограничен только подходящими по типу. В список также включаются дополнительные реквизиты документа подходящего типа.


Таким образом, библиотека поддерживает ролевую адресацию с использованием, как статичных объектов адресации, так и определяемых динамически.
Если для выполнения этапа требуется параллельное выполнение нескольких однотипных задач разными исполнителями, например, при комиссионном голосовании, то в форме выбора исполнителя этапа необходимо установить флаг Этап выполняется несколькими исполнителями (параллельно), после чего будет возможно указание нескольких исполнителей этапа

•	Исполнители – перечень исполнителей этапа, каждому из которых будет создана задача по выполнению этапа.
•	Этап куратора – этап шаблона процесса, исполнитель которого будет иметь право контролировать ход выполнения группового этапа, а именно прерывать и восстанавливать задачи его исполнителей группового этапа. Предполагается, что этап куратора должен иметь те же условия старта, что и контролируемый им групповой этап, но при этом сам этап куратора не может быть выполнен при наличии активных курируемых задач.

•	Норматив – плановое время выполнения этапа в часах. Норматив используется при расчете срока выполнения задачи и считается от даты создания задачи. При использовании графиков работы срок выполнения этапа будет рассчитан с учетом рабочего времени. В формах списков задач сроки, рассчитанные от норматива, будут отображаться в графе Срок по нормативу.

•	Порядок выполнения – настройка порядка выполнения этапа производится в отдельной форме, где настраиваются правила старта и прерывания этапа. У каждого этапа, кроме стартового, необходимо заполнить условие старта, которое зависит от результатов выполнения предыдущих этапов и от некоторого условия, составленного из значений реквизитов документа. Открытие формы происходит при нажатии на гиперссылку в ячейке.

На форме можно заполнить реквизит:
•	Не запрещать отмену выполнения задач этапа при наличии прерванных ими других задач – устанавливается, если разрешена отмена выполнения задач этапа, которые при своем выполнении прервали выполнение других задач. При этом прерванные задачи будут восстановлены.
На закладке Старт этапа необходимо заполнить реквизиты:
•	Является стартовым этапом процесса – устанавливается для этапа, который должен быть запущен при создании документа. Стартовый этап может быть только один.
•	Порядок старта этапа – выбирается одно из значений:
o	Стартовать этап после выполнения всех отмеченных этапов, если старт этапа зависит от результатов выполнения других этапов по логическому «И».
o	Стартовать этап после выполнения любого из отмеченных этапов, если старт этапа зависит от результатов выполнения других этапов по логическому «ИЛИ».
•	При повторном запуске этапа отправлять предыдущему исполнителю этапа – устанавливается, если при повторном запуске этапа, например, при отправке на доработку, требуется адресовать задачу тому же исполнителю роли, который выполнил этот этап в предыдущий раз. Реквизит виден, если в качестве исполнителя этапа выбрана роль.
Табличная часть будет автоматически заполнена этапами шаблона. В ней необходимо отметить этапы-предшественники, результаты их выполнения и условия, при выполнении которых этап будет запущен.

В качестве результата выполнения этапа можно указать один из статусов, установленных этапом-предшественником либо предопределенное значение Любой результат. Если этап-предшественник – групповой, то для каждого результата такого этапа будет предложено дополнительно выбрать один из двух вариантов: Любая задача или Все задачи.

Условие задается в виде отбора, составленного из значений реквизитов документа, а также типов значений реквизитов (только для реквизитов составного типа). Таким образом, библиотека позволяет настроить маршрутизацию обработки документа в рамках одного шаблона в зависимости от некоторой комбинации ключевых реквизитов документа.
На закладке Прерывание этапа настраивается порядок досрочного прерывания этапа. Это может потребоваться, например, если запущено параллельное выполнение этапов, и, в случае отрицательного результата в одном из них, второй уже не имеет смысла выполнять.

Табличная часть будет автоматически заполнена этапами шаблона. В ней необходимо отметить этапы-предшественники, результаты их выполнения и условия, при выполнении которых этап будет прерван. Прерывание этапа зависит от результатов выполнения других этапов только по логическому «ИЛИ». Заполнение результатов и условий прерывания в табличной части закладки Прерывание этапа производится аналогично закладке Старт этапа.

•	Зона ответственности – настройка зон ответственности осуществляется в отдельной форме, где производится разграничение зон ответственности исполнителей по реквизитам документа, управление доступностью реквизитов для редактирования и изменения, настройка обязательности заполнения реквизитов, управление необходимостью проведения документа на этапе, настройка условий выполнения этапа, настройки по работе с присоединенными файлами. 


Ключевые свойства параметров этапов в форме шаблона процесса отображаются в виде флагов в колонках с пиктограммами:
o	Зона ответственности – флаг отображается при заданных настройках для реквизитов в зоне ответственности – ответственность, редактирование, изменение, обязательность.
o	Обособленная зона ответственности – флаг отображается при установленной настройке обособленной зоны ответственности для этапа процесса. Реквизиты такого этапа включаются в состав электронной подписи только на данном этапе, а реквизиты, подписанные на других этапах на включаются в состав электронной подписи.
o	Подписывать первичные документы – флаг отображается при отмеченных для подписания первичных документах.
o	Требования к проведению – флаг отображается при установленных требованиях к проведению в зависимости от результата выполнения этапа.
o	Запрет проведения, отмены проведения, перепроведения – флаг отображается при установленных настройках Запретить проведение, в том числе перепроведение документа для этапа.
o	Требования к выполнению – флаг отображается при установленных требованиях к выполнению в зависимости от результата выполнения этапа.
o	Запрещено добавление файлов – флаг отображается при установленной настройке Запрещено добавление файлов.
o	Запрещено изменение файлов – флаг отображается при установленной настройке Запрещено изменение файлов.
o	Обязательно наличие файлов – флаг отображается при установленной настройке Наличие файла(ов) обязательно.

Открытие формы настройки происходит при нажатии на гиперссылку в ячейке или  при нажатии на одну из ячеек колонок с пиктограммами.



На закладке Зона ответственности будет автоматически заполнено дерево реквизитов шапки и табличных частей документа согласно метаданным документа для задания настроек. При необходимости включить в зону ответственности данные, не являющиеся реквизитами документа, необходимо описать имена этих данных, правила определения их доступности, контроля заполнения и включения в состав подписываемых данных в переопределяемом модуле ПроцессыОбработкиДокументовПереопределяемый, а именно в процедурах ПриЗаполненииДереваЗонОтветственности, УправлениеДоступностьюРеквизитовСогласноШаблону, ЗначениеРеквизитовОбъектаПоСоставу и ПриКонтролеИзмененияРеквизитов.
В дереве реквизитов можно для каждого реквизита отметить следующие признаки:
•	Ответственность – признак включения реквизита в зону ответственности исполнителя. Термин Ответственность (в контексте шаблона процесса) – это набор данных (реквизитов документа), за заполнение которых отвечает один исполнитель. Данные в зоне ответственности должны быть недоступны для изменения следующими исполнителями. Если для выполнения этапа требуется электронная подпись, то данные в зоне ответственности включаются в состав подписываемых данных.
•	Редактирование – признак доступности реквизита для редактирования на данном этапе процесса.
•	Изменение – признак доступности реквизита для изменения на данном этапе процесса.
•	Обязательный – признак обязательности заполнения реквизита на данном этапе процесса.
Правила настройки ответственности и доступности данных:
1.	Один реквизит может входить в зону ответственности только одного этапа, но при этом разрешается включать один реквизит в зону ответственности разных этапов при условии, что эти этапы не входят ни в один общий маршрут.
2.	Если реквизит входит в зону ответственности этапа, то он по умолчанию доступен на этом этапе с возможностью отключить доступность.
3.	Если реквизит не входит ни в чью зону ответственности, то он доступен на всех этапах с возможностью отключить доступность.
4.	Если реквизит входит в чужую зону ответственности, то его необходимо сделать недоступным для изменения, если чужой этап выполняется раньше.
При записи шаблона процесса выполняется проверка на выполнение пунктов 1 и 4.
Настройки ответственности и доступности реквизитов по всем этапам шаблона можно просмотреть при помощи печатной формы «Настройки ответственности».
Также на закладке Зона ответственности можно заполнить реквизиты:
•	Обособленная зона ответственности – признак обособленности данных в зоне ответственности текущего этапа от других этапов. Если флаг установлен, то в состав электронной подписи текущего этапа не будут включены реквизиты, подписанные на предыдущих этапах, а реквизиты в текущей зоне ответственности, в свою очередь, не будут подписываться на следующих этапах.
На закладке Первичные документы имеется возможность выбрать печатные формы, в которых требуется выводить штамп электронной подписи, использовавшейся при подписании электронного документа на этом этапе. 
На закладке доступны настройки:
•	Подписывать первичные документы – устанавливается, если в печатные формы документа требуется выводить штамп электронной подписи, которой документ был подписан на этом этапе.
При помощи переключателя Все / Выбранные и отметок в списке можно выбрать, в каких печатных формах необходимо выводить штампы электронной подписи при выполнении этапа процесса.


Формирование и подписание файлов формуляров первичных документов

Начиная с версии ПОД 1.0.17.1, при условии интеграции механизма формирования и подписания файлов формуляров первичных документов в прикладное решение, для формирования и подписания файлов формуляров первичных документов необходимо выполнить настройку в колонке «Настройка формирования и подписания формуляра» в списке первичных документов (закладка «Первичные документы»).

Формирование и подписание формуляров в формате PDF необходимо для обеспечения требований архивных систем и повышения степени юридической значимости электронного документооборота в учреждении.



Если требуется создавать и подписывать файл формуляра исключительно на настраиваемом этапе (на следующем этапе документ будет дополнен и формуляр изменится), то следует выбирать вариант настройки «Формировать и подписывать только на этом этапе».

Если предполагается, что на текущем этапе исполнитель определит заполнение формуляра, создаст его файл и подпишет, а исполнитель следующего этапа только подписывает, то на этапе создания и подписания следует выбрать вариант настройки «Формировать и подписывать на этом и следующих этапах», а на следующем этапе указать вариант настройки «Подписывать ранее созданный».

При настройке формирования и подписания перед началом работы пользователей следует протестировать работу алгоритма по формированию и подписанию формуляров.

Ограничения механизма формирования и подписания файлов формуляров: если печатная форма первичного документа создается в прикладном решении на клиенте, то настраивать формирование и подписание формуляра можно только в случае добавления специального алгоритма формирования файла формуляра на сервере (следует использовать процедуру РезультатПечатиПредставленияДокумента() в общем модуле ПроцессыОбработкиДокументовПереопределяемый) или после изменения принципа формирования печатной формы с клиентского на серверный. Второй вариант - можно сохранять и присоединять файлы формуляров в качестве присоединенных файлов к документу учета при условии, что настройка подписания таких файлов включена.

После подписания формуляры будут отражаться в форме «Процесс» на закладке «Формуляры». 



По ссылке «Файл формуляра» можно открыть для просмотра файл формуляра и просмотреть для него список электронных подписей.



По кнопке F2 можно открыть форму со списком электронных подписей файла выбранного файла формуляра.



На закладке «Визуализация формуляров» показан список формуляров с штампами электронных подписей. 



При определении настроек формирования и подписания формуляров необходимо убедиться, что выбранные печатные формы доступны и корректно формируются на каждом этапе обработки документов.



Для сохранения настроек необходимо нажать кнопку Готово.

Если у шаблона есть хотя бы один этап с формированием и подписанием формуляров первичных документов, то в списке шаблонов будет стоять отметка в колонке «Подписание формуляров».





На закладке Требования к проведению можно заполнить реквизиты:
•	Запретить проведение, отмену проведения документа – устанавливается, если исполнителю в процессе выполнения своего этапа запрещено изменять признак проведенности документа
o	в том числе перепроведение – устанавливается, если исполнителю этапа также запрещено перепроводить документ.
•	В табличной части формы для каждого результата выполнения этапа можно указать требования к проведению документа в момент выполнения этапа. Для выбора доступен один из вариантов:
o	Не предъявляется – требований к проведению документа не предъявляется (вариант по умолчанию).
o	Должен быть проведен – при выполнении этапа документ должен быть проведен.
o	Должен быть не проведен – при выполнении этапа документ должен быть не проведен.
Требования к проведению проверяются также при отмене выполнения задач, например, нельзя будет отменить задачу, выполненную с требованием "Должен быть не проведен", если в текущий момент документ уже проведен.
На закладке Требования к выполнению имеется возможность для каждого результата выполнения этапа указать условие его выполнения. При невыполнении этого условия выполнение этапа будет запрещено с выводом соответствующего сообщения пользователю.

Условие выполнения задается в виде отбора, составленного из значений реквизитов документа, а также типов значений реквизитов (только для реквизитов составного типа).

На закладке Присоединенные файлы доступны настройки:
•	Запрещено добавление файлов – исполнителю этапа процесса запрещено добавление присоединенных файлов
•	Запрещено изменение файлов – исполнителю этапа процесса запрещено изменение присоединенных файлов
•	Наличие файла(ов) обязательно – для выполнения этапа процесса с неотрицательным результатом выполнения требуется наличие хотя бы одного присоединенного файла
•	Подписывать файлы ЭП – при выполнении этапа с созданием электронной подписи этим же сертификатом будут подписаны присоединенные к документу файлы

•	Влияние на процессы – настройка влияния на процессы осуществляется в отдельной форме, где можно настроить влияние выполнения текущего этапа на другие процессы (процессы других документов). Функционал библиотеки позволяет при выполнении этапа по текущему документу автоматически выполнить этапы других документов и перевести их далее по их бизнес-процессам. Данная возможность может быть востребована при наличии некоторых связанных документов и необходимости синхронно выполнять этапы их обработки, например:
o	Требуется при переводе выписки с банковского счета в статус «Загружена» переводить исполняющие документы, которые она содержит, в статусы «Исполнен».
o	При переводе счета-фактуры в статус «Отражен в учете» переводить его документ-основание в статус «Введен счет-фактура»
Обязательным условием возможности настройки такой связи является наличие ссылок на зависимые документы в метаданных текущего документа либо наличие дополнительной функции для используемых типов документов, описанной в методе ПроцессыОбработкиДокументовПереопределяемый.ОписаниеФункцийПоискаЗависимыхОбъектов.
Открытие формы настройки происходит при нажатии на гиперссылку в ячейке.

В табличной части формы необходимо заполнить данные о влиянии текущего этапа на другие:
•	Результат выполнения текущего этапа – результат выполнения текущего этапа. Выбирается из предопределенного списка результатов этапа;
•	Зависимый шаблон – зависимый шаблон, этап которого необходимо синхронно выполнить. Выбирается из справочника Шаблоны процессов;
•	Зависимый этап – этап зависимого шаблона, который необходимо выполнить. Выбирается из предопределенного списка этапов зависимого шаблона;
•	Установить статус – статус, который должен быть установлен при выполнении зависимого этапа. Выбирается из предопределенного списка результатов зависимого этапа;
•	Связь с объектом – путь к реквизиту документа, содержащему ссылку на зависимый документ, или идентификатор дополнительной функции. Выбирается из заранее подготовленного списка путей, ограниченного подходящими типами реквизитов, и дополнительных функций поиска.

•	Доп. обработчики / События – управление подключением дополнительных обработчиков осуществляется в отдельной форме, где можно указать, какие обработчики необходимо запускать при выполнении этапа.
Дополнительные обработчики, доступные для выбора в шаблоне, должны быть предварительно описаны в общих модулях ПроцессыОбработкиДокументовОбработчикиПереопределяемый и ПроцессыОбработкиДокументовКлиентОбработчикиПереопределяемый (см. раздел Подключаемые обработчики).
Также форма используется для указания событий, которые должны инициировать выполнение этапа. Перечень событий должен быть предварительно описан в методе ПроцессыОбработкиДокументовПереопределяемый. ОписаниеСобытийИнициирующихВыполнениеЭтапов
Открытие формы настройки происходит при нажатии на гиперссылку в ячейке.

Табличная часть будет автоматически заполнена списком результатов текущего этапа.
На закладке Дополнительные обработчики для каждого результата имеется возможность заполнить графы:
•	Клиент – список имен дополнительных клиентских обработчиков.
•	Сервер, до транзакции – список имен дополнительных серверных обработчиков, которые необходимо выполнить до транзакции выполнения этапа.
•	Сервер, в транзакции – список имен дополнительных серверных обработчиков, которые необходимо выполнить в одной транзакции с выполнением этапа.
Если в графе выбрано несколько обработчиков, то они будут выполнены в соответствии с порядком их указания в этой графе.
На закладке Инициирующие события для каждого результата имеется возможность заполнить графу:
•	Событие – имя события, инициирующего выполнение этапа с соответствующим результатом.


На закладке Схема имеется возможность сформировать, проверить, сохранить, распечатать графическую схему настроенного процесса. Следует обратить внимание на связи между этапами, правильно ли они настроены, нет ли результатов выполнения этапов, которые незапланированно приводят к завершению процесса.

Формирование графической схемы осуществляется при помощи кнопки Сформировать схему.

Настройка использования шаблонов
Форма настройки использования шаблонов процессов вызывается при помощи команды Настройка использования шаблонов в панели настроек процессов обработки документов или по кнопке Настроить использование в форме списка шаблонов процессов. В форме производится назначение использования шаблонов процессов для типов документов, настраиваются условия использования.
Список типов документов заполняется автоматически согласно типам документов, указанным в определяемом типе ПредметПроцессаОбработкиДокументов при внедрении подсистемы.

В форме заполняется колонка:
•	Шаблон процесса – шаблон процесса из справочника Шаблоны процессов. Указание шаблона процесса для конкретного типа документа является признаком использования данного шаблона при работе с документами данного типа.
При включении функциональности Использовать несколько шаблонов для одного типа документа в форме настроек использования шаблонов становится доступно добавление нескольких шаблонов для одного типа документа и указание условий использования каждого шаблона.

Условие использования шаблона задается в виде отбора, составленного из значений реквизитов документа.
Примечание. Требуется, чтобы условия использования различных шаблонов для одного типа документа не пересекались, иначе при создании нового документа ни один процесс не будет запущен.

Для просмотра списка всех используемых шаблонов, и заданных настроек их использования может использоваться отчет Шаблоны процессов по документам. В отчете отображается перечень всех шаблонов процессов по типам документов, их количество и заданные условия использования.

Регламентные интервалы
Библиотека «Процессы обработки документов» предоставляет возможность устанавливать и контролировать сроки выполнения не только для отдельных этапов процесса, но и для последовательностей этапов – регламентных интервалов.
Регламентный интервал – это последовательность этапов шаблона процесса, следующих один за другим и функционально связанных друг с другом. Как правило, именно сроки выполнения регламентных интервалов отражаются в графике документооборота организаций, например, для централизованных бухгалтерий график документооборота может состоять из двух интервалов: обработка документа обслуживаемым учреждением и обработка документа централизованной бухгалтерией. При этом график не регулирует нормативы конкретных этапов и исполнителей в рамках каждого интервала – для него это не имеет значения, нормативы для этапов могут быть установлены уже в конкретных организациях.
Для использования регламентных интервалов необходимо включить функциональность Регламентные интервалы в панели настроек процессов обработки документов.
Справочник Регламентные интервалы
Справочник Регламентные интервалы подчинен справочнику Шаблоны процессов и содержит перечень регламентных интервалов шаблона.

Список регламентных интервалов шаблона процесса открывается по одноименной команде панели навигации элемента справочника Шаблоны процессов.

В форме элемента справочника Регламентный интервал необходимо заполнить реквизиты:
•	Срок выполнения – срок выполнения регламентного интервала, к которому должен быть выполнен конечный этап регламентного интервала. Настройка срока выполнения производится в отдельной форме, открываемой по гиперссылке.

В форме выбора срока выполнения регламентного интервала можно заполнить реквизиты:
•	Срок выполнения интервала зависит от времени начала первого этапа – устанавливается в случае, когда срок выполнения интервала зависит от времени начала выполнения интервала. Например, это может понадобиться для настройки вида «Если документ поступил до 14:00, то срок обработки …, а если после 14:00, то срок обработки …»;
Если реквизит установлен, то в форме появятся дополнительные реквизиты для заполнения.
•	Количество часов – сколько часов отводится на выполнение регламентного интервала. При использовании графиков работы имеются в виду рабочие часы;
•	Количество дней – сколько дней отводится на выполнение регламентного интервала. При использовании графиков работы имеются в виду рабочие дни.
•	Вариант указания конца дня – позволяет уточнить время окончания последнего дня при расчете срока выполнения. Для выбора доступен один из трех вариантов:
o	До конца рабочего дня – при использовании графиков работы будет указано время окончания рабочего дня, иначе – 23:59
o	До указанного времени – для ручного указания времени окончания дня
o	Окончание дня не указано – если интервал должен завершиться в то же самое время суток, когда он и начался.
•	Начальный этап – начальный этап регламентного интервала, при создании которого будет произведен расчет срока его выполнения. Выбирается из этапов шаблона процесса.
•	Конечный этап – конечный этап регламентного интервала, при выполнении которого регламентный интервал документа будет считаться выполненным. Если регламентный интервал состоит только из одного этапа, то его следует указать и в качестве начального и в качестве конечного.
•	Этапы – таблица этапов регламентного интервала. Заполняется автоматически при выборе начального и конечного этапов интервала согласно найденным маршрутам от начального до конечного этапов. Состав и порядок этапов в таблице не редактируются, но можно указать нормативы этапов, отличные от указанных в шаблоне процесса.
•	Наименование – наименование регламентного интервала, по умолчанию формируется из наименований начального и конечного этапов
•	Куратор – пользователь, имеющий право на изменение рассчитанных сроков регламентных интервалов документов. Выбирается из справочников Пользователи и Роли исполнителей.
Ввод в действие и механика работы
Для начала использования регламентного интервала, его необходимо ввести в действие при помощи команды Ввести в действие на форме списка регламентных интервалов. Введенные в действие интервалы отмечаются значком   в форме списка и подсказкой «Регламентный интервал введен в действие» в форме элемента регламентного интервала.
Регламентные интервалы документов имеют следующие особенности:
1.	Регламентный интервал документа создается в момент создания задачи по этапу, являющемуся начальным для данного интервала, при условии, что регламентный интервал введен в действие.
2.	Регламентный интервал документа отмечается как выполненный в момент выполнения этапа, являющего конечным для данного регламентного интервала, при условии, что следующий этап обработки документа не входит в состав этого регламентного интервала.
3.	Регламентный интервал документа отмечается как прерванный в момент выполнения этапа, не являющего конечным для данного регламентного интервала, при условии, что следующий этап обработки документа не входит в состав этого регламентного интервала.
4.	При создании регламентного интервала документа рассчитываются:
•	Срок выполнения регламентного интервала.
•	Сроки выполнения этапов, входящих в состав регламентного интервала по правилу: срок выполнения конечного этапа равен сроку выполнения регламентного интервала, срок выполнения предыдущего этапа равен сроку выполнения последующего этапа минус норматив этого последующего этапа (с учетом рабочего графика) и так далее. Последним рассчитывается срок выполнения начального этапа. В формах списков задач эти сроки будут отображаться в графе Срок по регламенту.
5.	Сроки выполнения этапов регламентного интервала, рассчитанные при его создании, далее не подлежат пересчету.
6.	В один момент времени у документа не может быть более одного активного интервала, поэтому не допускается ввод в действие двух и более регламентных интервалов с одинаковым начальным этапом.
Мониторинг и изменение сроков выполнения
Список текущих незавершенных регламентных интервалов открывается при помощи команды Текущие регламентные интервалы

Если текущий пользователь является куратором некоторых регламентных интервалов, то можно отобрать только их, установив флажок Показывать только интервалы на моем контроле.
Куратор регламентного интервала может открыть карточку регламентного интервала документа и при необходимости изменить срок выполнения интервала с автоматическим пересчетом сроков этапов интервала.

После изменения срока выполнения регламентный интервал документа необходимо записать.

Для просмотра списка выполненных регламентных интервалов в библиотеке предназначен отчет Анализ выполнения регламентных интервалов

В отчете выводятся выполненные регламентные интервалы документов с группировкой по шаблонам с отображением планового, фактического сроков выполнения и отклонения от плана (отрицательное отклонение означает, что выполнение интервала было просрочено). Для строк с промежуточными итогами рассчитывается среднее отклонение от плана. Доступна установка отбора по периоду и шаблону процесса.

Электронная подпись
В соответствии с Федеральным законом РФ от 06.04.2011 № 63-ФЗ «Об электронной подписи» (далее – Закон № 63-ФЗ) электронная подпись – это реквизит электронного документа, который считается аналогом собственноручной подписи и печати.
С помощью электронной подписи библиотека «Процессы обработки документов» позволяет:
•	осуществить дополнительный контроль доступа при выполнении этапа обработки документа при помощи запроса пароля закрытого ключа сертификата либо пароля входа в программу в случае использования простой электронной подписи;
•	подписать набор реквизитов, входящих в зону ответственности исполнителя этапа, при выполнении этапа обработки документа;
•	подписать файлы, присоединенные к документу, при выполнении этапа обработки документа (только для усиленной электронной подписи);
•	вывести штамп визуализации электронной подписи в печатные формы документа;
•	проверить электронную подпись.
Поддерживается использование простой и усиленной электронной подписи, для использования которых необходимо включить функциональность Усиленная подпись и/или Простая подпись в панели настроек процессов обработки документов.
Для усиленной электронной подписи поддерживается выбор машиночитаемой доверенности (МЧД) после выбора сертификата ЭЦП при подписании электронного документа.
Настройка усиленной электронной подписи
Библиотека «Процессы обработки документов» не располагает собственным функционалом для установки и настройки усиленной электронной подписи. Для этих целей предлагается использовать функционал подсистемы БСП «Электронная подпись» и документацию к подсистеме.
В целом, для начала использования усиленной электронной подписи при выполнении этапов необходимо:
•	Установить программу электронной подписи (криптопровайдер).
•	Настроить криптопровайдер.
•	Указать параметры криптопровайдера в прикладном решении.
•	Получить сертификат и указать его в прикладном решении.
Настройка простой электронной подписи
Для использования простой электронной подписи не требуется функциональность других библиотек и наличия сторонних программ, однако согласно Закону № 63-ФЗ признание электронных документов, подписанных простой электронной подписью, равнозначным собственноручно подписанным документам, должно быть закреплено в нормативных правовых актах или соглашениях между участниками электронного взаимодействия. С примером Положения об использовании простой электронной подписи для внутреннего документооборота, разработанным фирмой «1С», можно ознакомиться здесь https://its.1c.ru/db/metod81#content:7581:hdoc
В библиотеке имеется возможность формирования документов, обосновывающих применение простой электронной подписи. Для этого в форме реестра ключей ПЭП в подменю Оформить документы можно воспользоваться командами:
•	Положение об использовании ПЭП – формирование положения об использовании простой электронной подписи для внутреннего документооборота
•	Уведомление об использовании ПЭП – формирование уведомлений об использовании простой электронной подписи для внутреннего документооборота. Перед печатью необходимо указать список пользователей, для которых следует сформировать уведомления.
Шаблоны документов можно изменить при помощи механизма редактирования макетов печатных форм подсистемы БСП. В списке макетов указанные шаблоны принадлежат объекту «Подготовка документов (процессы обработки документов) (Обработка)»
Для заполнения данных организации при формировании документов необходимо описать логику их заполнения в переопределяемом методе ЗаполнитьРегистрационныеДанныеОрганизации общего модуля ПроцессыОбработкиДокументовПереопределяемый.
Для идентификации лица, подписавшего документ, по его простой электронной подписи, в самой подписи хранится информация о полном имени пользователя, организации пользователя и его должности. Для заполнения соответствующей информации необходимо описать логику ее получения в переопределяемом методе ЗаполнитьСведенияОПользователе общего модуля ПроцессыОбработкиДокументовПереопределяемый.
Реестры выданных и отозванных ключей простой электронной подписи
В библиотеке имеется возможность хранить перечень ключей простой электронной подписи, которые были выданы пользователям. Датой выдачи такого ключа можно считать дату ознакомления пользователя с Положения об использовании простой электронной подписи, а датой отзыва – например, дату увольнения.
Реестр ключей простых электронных подписей открывается по одноименной гиперссылке в форме настройки процессов обработки документов.

В форме списка доступно добавление и удаление ключей простых электронных подписей в разрезе пользователей с указанием даты выдачи и даты отзыва для каждого ключа. Если дата отзыва не указана, ключ считается бессрочно действующим с даты выдачи.
В форме реестра ключей ПЭП в подменю Отчеты можно сформировать отчеты:
•	Реестр выданных ключей ПЭП – перечень действующих ключей пользователей с указанием даты выдачи, формируется на указанную дату

•	Реестр отозванных ключей ПЭП – перечень отозванных ключей пользователей с указанием даты выдачи и даты отзыва, формируется на указанную дату

Если при выполнении этапа процесса у исполнителей требуется проверять наличие действующего ключа простой электронной подписи, то для этого в настройках процессов обработки документов следует установить флаг Проверить наличие ключа простой электронной подписи в реестре. Соответственно, если при выполнении этапа у пользователя нет записи с ключом или этот ключ уже отозван, то выполнение этапа будет запрещено с выводом соответствующего сообщения.
Использование электронной подписи для подписания документов
Требование о запросе электронной подписи при выполнении этапа определяется в справочнике Этапы процессов значением реквизита Требуется ЭП табличной части Результаты выполнения. Если реквизит установлен, то соответствующая этому результату команда на форме будет отмечена значком  .

При выполнении этапа, требующего усиленную электронную подпись, будет вызвано стандартное окно БСП для выбора сертификата (если текущему пользователю доступно несколько сертификатов) и ввода пароля закрытого ключа сертификата.

Если выполнение этапа требует установки простой электронной подписи, то будет открыто окно для подтверждения пароля входа в программу.

При наличии разграничений по ответственности исполнителей данные в зоне ответственности исполнителя будут подписываться при помощи электронной подписи. Подписываемый набор данных можно предварительно просмотреть, нажав на гиперссылку в окне подписи документа.


Подписание формуляров первичных документов

Начиная с релиза 1.0.17.1, в ПОД доступно формирование и подписание формуляров первичных документов, если для эатапа выполнена соответствующая настройка в шаблоне процесса.

Если в шаблоне процесса для текущего этапа настроено формирование и подписание формуляров первичных документов, то при выполнении этого этапа будут программно созданы указанные формуляры в форматах MXL и PDF и отображены в окне подписания, где их можно открыть для просмотра.


Настройка подписи ссылочных данных
В файле с подписанными данными могут содержаться только реквизиты простых типов (строка, число, дата, булево), поэтому если в зону ответственности исполнителя входят ссылочные реквизиты документа, например реквизит Контрагент типа СправочникСсылка.Контрагенты, то для каждого ссылочного типа необходимо создать настройку перечня реквизитов для включения в состав подписываемых данных, то есть «расшифровать», какие именно реквизиты контрагента требуется подписать. Перечень реквизитов определяется организацией самостоятельно.
Открыть форму настроек подписи ссылочных данных можно при помощи команды Настройка подписи ссылочных данных в панели настроек процессов обработки документов или по кнопке Настроить в форме настройки зон ответственности шаблона процесса.

В форме списка настроек можно создать новую настройку подписи, изменить или удалить существующую настройку. Также в форме списка настроек расположены команды Загрузить настройки… и Сохранить настройки в файл…, с помощью которых можно выгружать/загружать настройки в файл/из файла для обмена настройками между однотипными конфигурациями (например, между областями «облачной» информационной базы). Подробное описание механизма приведено в разделе Обмен настройками подписи ссылочных данных.


В форме настройки необходимо заполнить реквизиты:
•	Тип данных – тип ссылочных данных, для которых необходимо создать настройку. Выбирается из справочника Идентификаторы объектов метаданных из групп объектов: Справочники, Планы видов характеристик или Планы счетов.
После выбора типа данных автоматически заполнится список реквизитов.
•	Реквизиты для включения в электронную подпись – в списке реквизитов необходимо отметить те, которые должны включаться в состав подписываемых.
Внимание. Если для включения в состав подписываемых данных будут отмечены реквизиты ссылочных типов, то программа выдаст предупреждение о необходимости создания аналогичной настройки для этих ссылочных типов.

При настройке состава реквизитов не следует допускать возникновения «зацикленных» связей. Например, если в справочнике Организации есть реквизит Руководитель со ссылкой на справочник Сотрудники, а у справочника Сотрудники есть реквизит Владелец – ссылка на справочник Организации, то при подписании документов может возникнуть ошибка вида Переполнение стека. Для ее исключения в настройке подписываемых реквизитов справочника Сотрудники не следует отмечать реквизит Владелец либо в справочнике Организации не отмечать реквизит Руководитель.
В связи с такими ограничениями, при выполнении команды Включить все в списке отмечаются только команды простых типов (Строка, Число, Дата, Булево). При необходимости добавления в данные подписи реквизитов ссылочных типов данных, их следует отметить вручную.
В общем случае не следует включать все реквизиты в состав подписываемых данных. Особенно это касается служебных реквизитов, либо реквизитов, значения которых устанавливаются независимо от конкретной информационной базы, например, поставщиком типовой конфигурации, так как в случае изменения этих реквизитов в будущем возможно возникновение ошибок проверки соответствия подписанных и текущих данных.

Настройка прав назначения исполнителей
При использовании ролевой адресации задачу может принять к исполнению и выполнить один из исполнителей роли. Все исполнители роли имеют равные возможности для выполнения задачи: задачу сможет выполнить тот, кто первым примет ее к исполнению. При этом возможна ситуация, когда ни один из исполнителей роли не будет принимать задачу к исполнению длительное время, либо пользователь, принявший задачу к исполнению, отсутствует (болезнь, командировка, отпуск и т.п.). Для контроля «зависших» задач и разрешения таких ситуаций библиотека «Процессы обработки документов» предоставляет возможность указать для роли исполнителей определенного контролирующего пользователя (или роль), имеющего право персонально назначать конкретных исполнителей для выполнения задач по обработке документов.
Открыть форму настроек прав назначения исполнителей можно при помощи команды Настройка прав назначения исполнителей в панели настроек процессов обработки документов.

В настройке заполняются реквизиты:
•	Назначающий исполнителей – пользователь, имеющий право назначать исполнителей. Выбирается из справочников Пользователи и Роли исполнителей.
•	Роль исполнителя – роль, исполнителей которых можно назначать.
Пользователь, имеющий право назначать исполнителей, может открыть список задач его подчиненных по команде Назначение исполнителей раздела Органайзер.

Функционал формы Задачи для назначения исполнителей:
•	Кнопка Сгруппировать по позволяет сгруппировать список задач по этапу процесса, автору, типу обрабатываемого документа.
•	Кнопка Назначить исполнителя позволяет выбрать из выпадающего списка одного из исполнителей роли и назначить его для выполнения выделенных в списке задач. При этом, назначенный таким образом исполнитель не будет иметь возможности отменить принятие задачи к исполнению.
•	Кнопка Отменить назначение позволяет отменить назначение и вернуть задачу на роль.

Передача прав исполнителей
По умолчанию в библиотеке применяется правило: отмена принятия к исполнению или отмена выполнения задачи возможны только тем же самым исполнителем, который принял к исполнению или выполнил задачу. В ряде случаев это может стать причиной дальнейшей невозможности обработки документа по бизнес-процессу при временном или постоянном отсутствии этого исполнителя на рабочем месте (болезнь, командировка, отпуск, увольнение и т.п.). Например, когда пользователь принял задачу к исполнению и ушел в отпуск, либо потребовалась отмена выполнения задачи сотрудника, который уже уволился. Для решения таких проблем библиотека предоставляет возможность временно предоставить права отмены выполнения и отмены принятия к исполнению задач одного пользователя другому. Права могут передаваться либо в рамках общей роли исполнителей (для задач с ролевой адресацией), либо без указания роли (для задач с прямой (персональной) адресацией).
Форма настроек передачи прав исполнителей открывается при помощи команды Настройка передачи прав исполнителей в панели настроек процессов обработки документов.

В настройке заполняются реквизиты:
•	Способ передачи – способ передачи прав, для выбора доступен один из вариантов:
o	От роли к пользователю – передаются права от роли к пользователю, который может не являться исполнителем этой роли, используется для задач с использованием ролевой адресации.
o	От пользователя к пользователю в рамках одной роли – передаются права от одного пользователя к другому в рамках их общей роли, используется для задач с использованием ролевой адресации.
o	От пользователя к пользователю (для задач без ролей) – передаются права от одного пользователя другому, используется для задач без использования ролевой адресации
•	Роль исполнителей – роль, в рамках которой происходит передача прав либо роль, права которой передаются. Реквизит недоступен для заполнения для способа передачи От пользователя к пользователю (для задач без ролей).
•	От кого – пользователь, права которого передаются. Реквизит недоступен для заполнения для способа передачи От роли к пользователю.
•	Кому – пользователь, которому передаются права.
•	Действует с… по… – период, в течение которого действует передача прав. Дата окончания периода может быть не заполнена.
Пользователь, которому переданы права по отмене выполнения и отмене принятия к исполнению задач, имеет возможность выполнения указанных действий следующими способами:
•	При помощи команд Отменить принятие к исполнению и Отменить выполнение контекстного меню по отменяемой задаче в карточке процесса документа
•	При помощи отдельной формы Задачи с переданными правами, которую можно открыть из формы Мои задачи по обработке документов по команде Еще – Задачи с переданными правами либо из контекстного меню.

Функционал формы Задачи с переданными правами:
•	Кнопка Сгруппировать по позволяет сгруппировать список задач по этапу процесса, автору, исполнителю, типу обрабатываемого документа.
•	Кнопка К исполнению позволяет принять задачу к исполнению. После выполнения действия задача удалится из списка, и отобразится в списках текущих задач пользователя, где станет возможно ее выполнение. 
•	Кнопка Отменить принятие к исполнению позволяет отменить принятие к исполнению задачи и вернуть ее на роль.
•	Кнопка Отменить выполнение позволяет отменить выполнение задачи и вернуть ее на роль.
•	Кнопка Вернуть на роль исполнителя позволяет вернуть на роль задачу, которая была назначена одному из исполнителей, но еще не принята им к исполнению.
Управление отображением уже выполненных задач осуществляется при помощи флажка Показывать выполненные.

Дополнительные задания
Помимо обработки прикладных документов библиотека также предоставляет возможность организовать бизнес-процессы, которые напрямую не связаны с обработкой прикладных документов конфигурации, – дополнительные задания. Примерами дополнительных заданий могут быть поручения, уведомления, запросы, задания, напоминания и т.д., то есть некоторые бизнес-процессы, которые могут создаваться и выполняться пользователями, но для их регистрации в программе нет подходящих документов-объектов.
Справочник Виды дополнительных заданий
Справочник Виды дополнительных заданий содержит набор видов дополнительных заданий, которые могут использоваться в программе. Вид задания определяет представление дополнительного задания, а также может быть использован в условиях использования шаблонов для назначения разным видам заданий разных маршрутов движения.

В форме элемента справочника необходимо заполнить реквизит:
•	Наименование – представление дополнительного задания при отображении в формах, списках документов и задач.

Документ Дополнительное задание
Дополнительные задания реализованы в виде документов вида Дополнительное задание.

Дополнительные задания могут создаваться пользователями, у которых есть право создания и выполнения задач по обработке документов.

В форме задания доступны для заполнения реквизиты:
•	Вид задания – вид дополнительного задания.
•	Номер – номер документа по порядку, присваивается автоматически при записи.
•	Дата – дата документа, присваивается автоматически при записи.
•	Предмет – прикладной документ, по поводу которого создано дополнительное задание (не обязателен).
•	Содержание – содержание дополнительного задания, описательная часть.
•	Автор – пользователь, создавший задание, присваивается автоматически.

Имеется возможность прикрепления к заданиям внешних файлов.

Для расширения реквизитного состава дополнительного задания можно воспользоваться функционалом подсистемы БСП «Свойства».

После добавления дополнительных реквизитов они будут отображены и доступны для заполнения на форме дополнительного задания.

При этом если для документа добавить дополнительный реквизит типа СправочникСсылка.Пользователи, то его можно будет указать в качестве исполнителя этапа в шаблоне процесса для адресации задачи конкретному пользователю, которого автор задания укажет в этом реквизите. Таким образом, можно создавать адресные задания конкретным пользователям при использовании общего шаблона процесса и без необходимости создавать отдельные роли исполнителей.

Документы типа Дополнительное задание можно использовать в шаблонах процессов для создания процессов их обработки.

При этом в отличие от прикладных документов, дополнительные задания имеют смысл только в контексте какого-либо процесса, поэтому, если для нового задания не удалось найти подходящий шаблон процесса, то его запись будет запрещена.


Также библиотека предоставляет возможность создавать документы на основании дополнительных заданий. Для этого в общем модуле ПроцессыОбработкиДокументовПереопределяемый в процедуре ОписаниеКомандСозданияНаОснованииДополнительногоЗадания необходимо заполнить список команд создания на основании, а в процедуре ОбработкаЗаполненияНаОснованииДополнительногоЗадания описать код обработчиков заполнения для каждого типа документа.


Дополнительные колонки списков задач
Для облегчения идентификации, поиска, сортировки и фильтрации задач и документов, с ними связанных, в списках задач предусмотрена возможность отображения дополнительных колонок, значения которых могут быть сформированы из реквизитов документов. Примерами дополнительных колонок могут быть «Номер», «Дата», «Сумма», «Контрагент», «Договор», «Комментарий».
Список дополнительных колонок списков задач можно открыть по одноименной команде в панели настроек процессов обработки документов.

Для каждой дополнительной колонки необходимо выполнить настройку, аналогичную настройке граф журналов документов 1с, а именно, для каждого типа документа указать реквизит, значение которого необходимо отображать в этой колонке. Если для типа документа не выбран ни один реквизит, то для задач по данному типу документа колонка будет не заполнена.

В форме дополнительной колонки доступны для заполнения реквизиты:
•	Заголовок – заголовок колонки в списке задач исполнителя
Табличная часть колонки автоматически заполняется всеми типами документов, указанными в определяемом типе ПредметПроцессаОбработкиДокументов, а на втором уровне дерева отображается список реквизитов шапки данного типа документа. Соответственно, для каждого типа документа можно отметить только один из реквизитов, либо не отмечать ни одного.
В командной панели таблицы есть вспомогательные команды:
•	Отметить реквизиты с именем… – позволяет массово отметить во всех типах документов реквизит с определенным именем, которое необходимо будет ввести в отдельном окне. Если у документа уже был отмечен реквизит с каким-либо другим именем, то вместо этого реквизита будет отмечен реквизит с указанным именем.
•	Снять отметки со всех реквизитов – позволяет массово снять отметки реквизитов у всех типов документов.
В группе команд Отбор находятся команды, позволяющие отобразить только типы документов с отмеченным реквизитом либо только типы документов без отмеченного реквизита. Также в поле поиска можно ввести имя или часть имени реквизита, которые необходимо отобразить. При этом вышеуказанные команды с установкой и снятием отметок работают только для отображаемых в данный момент типов документов и реквизитов, то есть с учетом отбора, – это позволяет, например, реализовать такой сценарий отметки реквизитов: сначала отметить во всех типах реквизит «Контрагент», потом отобрать только документы с незаполненным реквизитом и уже для оставшегося списка отметить реквизиты, например, с именем «Сотрудник», и т.д.
При записи дополнительной колонки производится планирование заполнения значений дополнительных колонок для тех типов документов, настройка которых была изменена. Непосредственное заполнение значений осуществляется регламентным заданием Заполнение дополнительных колонок задач, которое будет автоматически отключено после обработки всех имеющихся документов нужного типа. При этом запись/обновление значений колонок для новых документов будет производиться в событиях записи этих документов. Если требуется повторно запустить регламентное задание по всем значениям всех колонок, то это можно сделать по команде Запланировать заполнение колонок в подменю Еще формы списке колонок.
Также при записи дополнительной колонки производится расчет типов значений реквизитов, отображаемых в данной колонке: это требуется для ускорения работы отбора и сортировки по значениям дополнительных колонок в списках задач. Соответственно, при изменении в метаданных типа отображаемого реквизита документа может потребоваться перерасчет типов значений колонки. Это можно сделать по команде Еще – Обновить типы колонок, либо добавить обработчик обновления с вызовом процедуры ПроцессыОбработкиДокументов.ОбновитьТипыДополнительныхКолонок.
Управление отображением дополнительных колонок в формах списков задач пользователей осуществляется из формы списка колонок при помощи команд Включить отображение и Отключить отображение. Дополнительные колонки станут отображаться у пользователей при очередном открытии формы списка задач и по умолчанию будут выведены в конец списка.

При необходимости пользователь может отключить отображение колонок, поменять их местами и т.д. По значениям дополнительных колонок можно выполнять поиск и отбор задач (Ctrl + F).

Внимание. Вывод каждой дополнительной колонки приводит к замедлению динамического списка задач, поэтому при существенном замедлении работы рекомендуется отказаться от вывода некоторых дополнительных колонок.

Сервисные возможности и администрирование
Импорт / экспорт шаблонов процессов
Библиотека предоставляет возможность обмена шаблонами процессов между однотипными конфигурациями, что позволяет, например, централизованно вести настройку шаблонов в одной информационной базе и затем обновлять соответствующие шаблоны в других информационных базах при помощи загрузки файлов поставки.
Обработку Импорт / экспорт шаблонов процессов можно открыть из формы списка шаблонов.

Для выгрузки шаблонов на закладке Выгрузка данных следует:
•	указать имя файла, в который будут выгружены шаблоны процессов;
•	отметить шаблоны процессов, которые необходимо выгрузить.
Если выгружаемый шаблон является зависимым либо влияющим на другой шаблон, то все связанные шаблоны будут также автоматически отмечены к выгрузке с выводом соответствующего сообщения.

По кнопке Выгрузить шаблоны будет создан файл поставки шаблонов процессов, который может быть использован для обновления шаблонов в других информационных базах.
Для загрузки шаблонов на закладке Загрузка данных необходимо выбрать файл с поставкой шаблонов процессов. Из файла будет прочитана информация о дате выгрузки файла и его составе. Будет выведен список шаблонов, содержащихся в файле, и связанные с ними этапы и статусы. При этом автоматически будет выполнена попытка сопоставить справочники из файла со справочниками информационной базы по служебному реквизиту Идентификатор поддержки.
Для загрузки исполнителей необходимо установить флаг Загружать исполнителей (кроме пользователей), после чего отобразится таблица с сопоставлением ролей исполнителей в загружаемом файле и в информационной базе аналогично другим справочникам.
Для загрузки условий использования загружаемых шаблонов процессов необходимо установить флаг Загружать настройки использования шаблонов.

Если найти соответствующий элемент в базе не удалось, то в поле элемента будет выведена подсказка вида «шаблон не найден, будет загружен как новый», но, если известно, что такой элемент в базе есть, то его можно указать вручную.
По кнопке Загрузить шаблоны будет произведена загрузка / обновление шаблонов в информационной базе согласно файлу поставки. У вновь созданных элементов справочников (а также у сопоставленных вручную) будут установлены идентификаторы поддержки по данным файла поставки. При загрузке исполнителей в созданных при импорте ролях исполнителей не будут заполнены типы объектов адресации – их необходимо будет указать вручную после первичной загрузки.
После успешной загрузки будет выведено сообщение Шаблоны успешно загружены.

Формирование формуляров в формате PDF для документов учета прошлых периодов

Для документов учета прошлых периодов нет возможности пройти все этапы и сформировать и подписать файлы формуляров в формате PDF, поэтому в случае необходимости можно с помощью специальной обработки сформировать только итоговые файлы формуляров в форматах PDF и MXL со штампами электронной подписи данных документов в формате XML.

В состав ПОД 1.0.17 для этой цели включена обработка «Формирование представления ЭД для документов без формуляров».



Вначале следует определить период обрабатываемых документов (шаг 1).
Затем следует указать шаблоны процессов и устранить все замечания по списку печатных форм, которые будут сформированы как формуляры со штампами электронных подписей (шаг 2).
Можно заполнить все доступные шаблоны или только те шаблоны, которые использовались при обработке (длительная операция, будут проанализированы все процессы обработки за указанный период).
При этом шаблоны процессов, которые использовались в прошлых периодах, могут иметь замечания по настройкам использования первичных документов (например, включены все первичные документы, которые только возможны для документа учета). 
Можно в обработке сразу указать список печатных форм или сначала настроить список в шаблоне, а потом заполнить данные из него для обработки.
В настройках шаблонов необходимо включить только нужные виды первичных документов (печатных форм), сохранить (шаг 3).
Следует сформировать список документов учета (шаг 4).
На последнем этапе необходимо запустить процесс создания представлений формуляров для документов учета прошлых лет (шаг 5).

Подписание формуляров в формате PDF для документов учета прошлых периодов

Для документов учета прошлых периодов можно подписать сформированные итоговые файлы формуляров со штампами подписей XML файлов в форматах PDF и MXL в целях заверения корректности их составления. Это может быть полезно для передачи этих файлов в сторонние программы и архив.

В состав ПОД 1.0.17 для этой цели включена обработка «Подписание представления ЭД для документов без формуляров».

Специальная обработка «Подписание представления ЭД для документов без формуляров» позволит подписать ранее сформированные формуляры со штампами подписей для документов прошлых лет.
Обработка позволяет указать размер порции файлов для подписания (количество документов на подпись) и заполнить список подписываемых файлов представлений формуляров.



В поле «Количество документов на подпись» указано количество документов, которые составляют одну порцию подписания (по умолчанию это 1000 документов).
По кнопке «Подписать» пользователь открывает форму выбора и подписания ЭЦП, указывает сертификат ЭЦП и подписывает порцию электронных документов по кнопке «Подписать» в форме «Подпись документов».
Обмен настройками подписи ссылочных данных
Библиотека позволяет выгружать/загружать настройки подписи ссылочных данных в файл/из файла для обмена настройками между однотипными конфигурациями. Команды выгрузки и загрузки настроек находятся в форме Настройка подписи ссылочных данных в панели настроек процессов обработки документов.
Для сохранения настройки подписи в файл необходимо нажать кнопку Сохранить настройки в файл…, указать имя файла, в который будут выгружены настройки, и нажать Сохранить.

Выгружаются одновременно все имеющиеся настройки подписи.
После окончания выгрузки будет выведено сообщение: «Настройки подписи ссылочных данных выгружены в файл …».
Для загрузки настроек из файла необходимо нажать кнопку Загрузить настройки….

В открывшейся форме следует выбрать файл с выгруженными настройками и нажать кнопку Загрузить.
Установка флага Удалить существующие настройки подписи ссылочных данных позволяет полностью заменить текущую настройку на настройку из файла.
После окончания выгрузки будет выведено сообщение «Настройки подписи ссылочных данных загружены».

Обмен настройками дополнительных колонок списков задач
Библиотека позволяет выгружать/загружать настройки дополнительных колонок списков задач в файл/из файла для обмена настройками между однотипными конфигурациями. Команды выгрузки и загрузки находятся в форме списка колонок.
Для сохранения настроек в файл необходимо нажать кнопку Сохранить в файл…, отметить колонки, которые необходимо выгрузить, далее указать имя файла, в который будут выгружены настройки колонок, и нажать Сохранить.

Для загрузки настроек дополнительных колонок необходимо нажать кнопку Загрузить из файла, в открывшемся окне выбрать файл с колонками, сопоставить колонки из файла и колонки из базы (если требуется) и нажать кнопку Загрузить.


Принудительный запуск этапа процесса
В процессе обработки документа может возникнуть необходимость запустить определенный этап процесса, к которому невозможно перейти по схеме процесса, например, если процесс уже завершен, или при обнаружении ошибки на одном из пройденных этапов, к которому нельзя вернуться по схеме. Для решения таких задач предназначена обработка Запуск этапа процесса, которую можно открыть из раздела Администрирование.

В форме обработки необходимо заполнить реквизиты:
•	Тип документа – тип документа, по которому необходимо запустить этап. Выбирается из справочника Идентификаторы объектов метаданных.
•	Шаблон процесса – шаблон процесса, этап которого необходимо запустить. Выбирается из справочника Шаблоны процессов.
•	Этап процесса – этап процесса, который необходимо запустить. Выбирается из справочника Этапы процессов.
•	Статус – статус, который должен быть установлен при запуске этапа. Выбирается из справочника Статусы.
•	Исполнитель – исполнитель, которому будет адресована задача по выполнению запущенного этапа. Выбирается из справочников Пользователи или Роли и исполнители задач.
•	Комментарий для исполнителя – описание задачи, которое будет отображено исполнителю в форме документа.
В табличную часть необходимо подобрать документы, которые необходимо перевести на запускаемый этап. После добавления документа в табличную часть отображаются его текущий статус и количество незавершенных задач по документу.
Запуск этапа процесса осуществляется по кнопке Запустить этап.
При наличии незавершенных задач по документам предварительно будет выведен вопрос о принудительном прерывании этих задач.

После успешного запуска этапа будет выведено соответствующее сообщение.

Принудительное прерывание процессов выполнения задач
В библиотеке используется следующая схема блокировки задач на время их выполнения: при начале выполнения задачи по обработке документа (при нажатии на кнопку с результатом выполнения этапа) сама задача и обрабатываемый документ блокируются от изменения до завершения выполнения задачи либо до отказа пользователем от дальнейшего выполнения задачи либо до возникновения обрабатываемой ошибки при выполнении задачи. При этом на завершение выполнения задачи отводится некоторое время (по умолчанию – 1 час), по прошествии которого блокировка объектов автоматически будет снята. Но возможны нештатные ситуации, когда необходимо снять блокировку задач и документов, не дожидаясь окончания времени ожидания. Для этого предназначена форма Прерывание процессов выполнения задач

В верхней таблице формы отображаются текущие пачки выполняющихся задач с информацией об инициаторе, дате последнего обновления (изменения) состава пачки и состояние фонового задания, выполняющего данную пачку (выполняется, завершено, отменено, не найдено).
В нижней таблице формы отображается список выполняющихся задач. По кнопке Отбор по выделенной пачке имеется возможность управлять отображением задач: отобразить все или только задачи выделенной пачки.
Прерывание процесса выполнения пачки задач осуществляется по кнопке Прервать выполнение, после нажатия которой задачи и документы пачки будут разблокированы, а фоновое задание отменено, если оно было активно.

Работа с задачами по обработке документов
Общий алгоритм процесса обработки документа выглядит следующим образом:
1.	При создании нового документа определяется шаблон процесса, по которому он далее будет следовать. Шаблон определяется в соответствии с условиями использования, указанными в настройке использования шаблонов. Документу присваивается начальный статус и создается задача, соответствующая стартовому этапу.
2.	В соответствии с порядком выполнения этапов, указанном в шаблоне, после выполнения исполнителями своих задач определяются очередные этапы и их исполнители, которым создаются задачи по выполнению этих этапов. Одновременно при переходе от этапа к этапу меняется статус документа.
3.	Процесс обработки документа считается завершенным, если по нему не осталось невыполненных задач.
Задачи по обработке документов всегда создаются неявно, то есть автоматически при создании нового документа либо при выполнении задач-предшественников. Интерактивное создание задач не предусмотрено.
Задачи могут быть выполнены непосредственно из формы документа и из формы списка задач.

Работа со списком задач
Рабочее место исполнителя задач – список Мои текущие задачи по обработке документов на начальной странице.

В списке отображаются невыполненные задачи, адресованные текущему пользователю либо роли, одним из исполнителей которой является текущий пользователь.
В колонках со сроками выводятся:
•	Срок по нормативу – срок выполнения задачи, рассчитанный от даты ее создания в соответствии с нормативом этапа, установленным в шаблоне процесса либо в регламентном интервале.
•	Срок по регламенту – срок выполнения задачи, рассчитанный с учетом нормативов следующих исполнителей по регламентному интервалу так, чтобы общий срок выполнения регламентного интервала не оказался просрочен.
Красным отображаются просроченные сроки выполнения задач, оранжевым отображаются сроки, по которым наступил срок напоминания.
Функционал списка Мои задачи по обработке документов:
•	Кнопка Сгруппировать по позволяет сгруппировать список задач по этапу процесса, автору, типу обрабатываемого документа.
•	Кнопка К исполнению позволяет принять задачу к исполнению. При использовании ролевой адресации принятие задачи к исполнению одним из исполнителей роли автоматически исключает задачу из списков задач других исполнителей роли.
•	Кнопка контекстного меню Отменить принятие к исполнению позволяет отменить принятие задачи к исполнению и вернуть задачу на роль.
•	Кнопка контекстного меню Вернуть на роль исполнителя позволяет для непринятой к исполнению задачи очистить пользователя-исполнителя задачи и вернуть задачу на роль (доступна только при ролевой адресации).
•	Кнопка контекстного меню Прервать процесс выполнения позволяет прервать процесс выполнения задачи, а также задач, выполняющихся с ней в той же пачке.
•	Кнопка контекстного меню Информация об ошибке позволяет просмотреть информацию об ошибке в случае, когда была неуспешная попытка выполнить задачу.

•	Кнопка контекстного меню Задачи с переданными правами позволяет открыть форму задач других пользователей, от которых текущему пользователю переданы права по выполнению с их задачами ряда действий.
•	Кнопка контекстного меню Настройки исполнителя задач позволяет открыть форму персональных настроек исполнителя задач.
В списке задач имеется возможность их быстрого выполнения без открытия форм документов. Для этого можно воспользоваться кнопками-командами выполнения задач в правой части командной панели формы. При этом можно выделить несколько однотипных задач (относящихся к одному этапу) и выполнить их одновременно. Состав кнопок выполнения определяется этапом процесса выделенных в списке задач: при выделении нескольких задач, относящихся к разным этапам, кнопки выполнения задач не будут отображены.

Если групповое выполнение задач требует электронной подписи, то будет однократно вызвано диалоговое окно с вводом пароля закрытого ключа сертификата, и этой подписью будет подписан каждый документ в группе.
Непосредственно выполнение задач осуществляется в фоновом задании, на время выполнения которого на форму выводится сообщение о ходе выполнения задач с возможностью прервать процесс выполнения, а остальные элементы формы недоступны.

Кроме этого можно открыть список Мои задачи по обработке документов по соответствующей команде раздела Органайзер. В этом списке можно также увидеть и выполненные задачи, для чего необходимо включить флажок Показывать выполненные.

Выполненная задача может быть отменена (отозвана) (например, если исполнитель обнаружил ошибку после выполнения своего этапа или выполнил задачу случайно). Отмена выполнения возможна, если следующие задачи по обработке документа еще не были выполнены или приняты к исполнению. Для отмены выполнения задач предназначена команда контекстного меню Отменить выполнение. При отмене выполнения задачи производится удаление электронных подписей, установленных при выполнении этой задачи.

Работа с формами документов
Исполнитель может выполнить свою задачу по обработке документа непосредственно в форме документа.
Если для документа настроен и используется шаблон процесса, то форма документа при открытии будет дополнена кнопками-командами для выполнения задачи по обработке документа и другими элементами.

Описание добавляемых элементов формы документа:
•	Наименование текущего этапа – наименование текущего этапа процесса;
•	Кнопки-команды выполнения текущего этапа – состав кнопок определяется количеством возможных результатов выполнения этапа процесса. Кнопки, соответствующие отрицательным результатам, отображаются красным, положительным – зеленым;
•	Предыдущий исполнитель и его комментарий – предыдущий исполнитель и комментарий, который он указал при выполнении своего этапа. Если предыдущий исполнитель не оставил комментарий, то данный элемент не будет отображен;
•	Комментарий исполнителя – поле для ввода произвольного комментария, который будет отображен следующему исполнителю;
•	Команды переключения видимости комментария автора/исполнителя – переключение между комментариями предыдущего и текущего исполнителей. Отображаются только при наличии комментария предыдущего исполнителя;
•	Текущий статус – текущий статус документа.
Если форма документа открыта пользователем, не являющимся исполнителем текущего этапа процесса, то кнопки выполнения этапа и поля с комментариями ему не видны: отображается только текущий статус документа, а сам документ открывается только на просмотр.
Также при открытии формы документа исполнителем текущего этапа устанавливается доступность реквизитов документа для редактирования согласно его зоне ответственности, настроенной в шаблоне процесса.
Следует отметить, что редактирование документа возможно только текущими исполнителями и до непосредственного выполнения задачи, так как после выполнения текущей задачи документ перейдет на другой этап другому исполнителю. Поэтому работу, связанную с изменением документа (заполнение реквизитов, проведение), следует выполнить до нажатия на кнопку выполнения этапа.

Имеется возможность изменения шаблона процесса для записанного документа при выполнении следующих условий:
•	- текущий шаблон процесса не подходит по условия использования
•	- новый шаблон процесса подходит по условиям использования и является единственным подходящим шаблоном
•	- текущему пользователю доступно выполнение стартового этапа нового процесса
•	- по документу нет выполненных задач
При выполнении указанных условий в форме документа появится соответствующая подсказка о возможности смены шаблона и команда-гиперссылка с именем нового шаблона.


Карточка процесса
Карточка процесса содержит сводную информацию о процессе обработки конкретного документа. Ее можно открыть по команде Процесс панели навигации формы документа.

В карточке процесса содержатся данные:
•	Текущий статус документа;
•	История всех выполненных и текущих задач по документу с датами выполнения и установленными статусами;
Для просмотра выполненных задач необходимо включить флажок Показывать выполненные задачи. Для списка задач доступны команды контекстного меню Отменить принятие к исполнению и Отменить выполнение.
•	Список электронных подписей. Имеется возможность открыть, проверить, сохранить подписи, а также просмотреть и сохранить подписанные каждой подписью данные.
В подменю Еще доступны команды:
•	Карта маршрута – открыть графическую схему шаблона процесса документа, на которой текущий этап будет выделен красной рамкой
•	Текущий регламентный интервал – открыть карточку текущего (активного) регламентного интервала документа. Кнопка видна только в случае наличия такого регламентного интервала.
Для списка электронных подписей доступны команды:
•	Открыть – открыть окно с основными свойствами электронной подписи, из которого можно открыть форму с основными свойствами сертификата электронной подписи выделенной строки: кому и кем выдан, назначение и срок действия сертификата, на основе которого создана подпись;
•	Проверить – проверить выделенные электронные подписи. Проверка проходит в два этапа:
o	Проверка действительности подписи и сертификата. Если проверка не прошла, то в колонке Статус, Дата проверки будет установлено Не верна и указана дата проверки. Данная проверка выполняется только для усиленных электронных подписей.
o	Проверка соответствия подписанных и текущих данных документа. Если есть отличия в данных, то в колонке Статус, Дата проверки будет установлено Подписанные данные отличаются от текущих и указана дата проверки. Также в окно сообщений пользователя будет выведена информация с перечнем отличающихся данных.
•	Проверить все – проверить все электронные подписи.
•	Сохранить – сохранить электронную подпись на диск в файл
•	Подписанные данные, Просмотреть – просмотр файла с подписанными данными
•	Подписанные данные, Сохранить – сохранить файл с подписанными данными на диск
Если текущий пользователь является куратором активного группового этапа, то в карточке процесса будет отображена гиперссылка с возможностью открытия формы Ход выполнения группового этапа

В форме Ход выполнения группового этапа отображаются перечень исполнителей курируемого группового этапа и статусы их задач (Активна, Выполнена, Прервана, Нет задачи). Куратор этапа имеет возможность прерывать активные задачи исполнителей, создавать и восстанавливать ранее прерванные задачи.

Если в прикладное решение интегрирована функциональность формирования и подписания формуляров документов в форматах MXL и PDF, то в карточке процесса показываются закладки со списком файлов формуляров 



и визуализация формуляров.


Документы с процессами обработки
Форма Документы с процессами обработки содержит перечень всех документов, которым были назначены шаблоны процессов.

В форме отображаются документы, их текущие статусы и исполнители с учетом заданной адресации. Также в списке отображаются дополнительные колонки списков задач (если настроены). Имеется возможность отбора документов по типу документа, статусу, состоянию завершенности обработки документа, а также по значениям дополнительных колонок через меню Еще – Настроить список.
В форме можно отметить несколько документов, после чего выполнить одну из команд:
•	Печать -> Реестр документов – распечатывает реестр отмеченных документов. Перед печатью будет открыта вспомогательная форма, где можно отметить список колонок реестра и изменить их положение.

По кнопке Печать будет отображена печатная форма реестра отмеченных документов с выводом отмеченных колонок.

•	Выгрузить -> Подписанные данные с ЭП – выгружает во внешний файл архив с подписанными данными отмеченных документов и усиленными электронными подписями. Данные в архиве группируются по каждому документу в виде папки.

Настройки исполнителя задач
Персональные настройки исполнителя задач можно открыть из форм списков задач по кнопке Настройки исполнителя задач из контекстного меню либо из подменю Еще.

Состав настроек:
•	Показывать оповещения о новых задачах с интервалом – управление отображением всплывающих оповещений о новых задачах пользователя с указанием интервала опроса программы (в минутах) на наличие новых задач. При включении настройки, а также при входе в программу однократно отображается оповещение об общем количестве задач, далее – с указанным интервалом. Если за указанный интервал новых задач не появилось, то очередное оповещение не будет отображено.

Окно с оповещением содержит информацию об общем количестве задач, количестве новых задач с момента последнего оповещения, количестве срочных и просроченных задач.

Мониторинг задач
Библиотека предоставляет возможность мониторинга задач по обработке документов при помощи отчета Задачи по обработке документов. В отчете предусмотрен отбор по периоду и исполнителям.
Для отчета предусмотрены варианты:
•	Время выполнения задач – отображает список выполненных задач с нормативом, фактическим временем выполнения и отклонением от норматива. При использовании графиков работы фактическое время и отклонение рассчитываются в рабочих часах. Задачи группируются по роли, исполнителю и типу документа.

•	Текущие задачи – отображает список текущих (невыполненных) задач c указанием их плановых сроков выполнения по нормативу и по регламенту и текущим количеством дней просрочки.
•	Справка по исполнительской дисциплине – отображаются исполнители и количество их задач за указанный период. По задачам в строке дается уточнение, сколько задач выполнено и не выполнено. По выполненным задачам указывается количество выполненных в срок и не в срок задач. По невыполненным задачам указывается количество просроченных.


